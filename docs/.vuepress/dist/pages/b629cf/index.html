<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Docker 和 K8s | Arkrypto</title>
    <meta name="generator" content="VuePress 1.9.9">
    <link rel="icon" href="/img/favicon.ico">
    <link rel="stylesheet" href="https://at.alicdn.com/t/font_3129839_xft6cqs5gc.css">
    <noscript><meta http-equiv="refresh" content="0; url=https://www.youngkbt.cn/noscript/"><style>.theme-vdoing-content { display:none }</noscript>
    <meta name="description" content="My Wiki">
    <meta name="keywords" content="Arkrypto, ComputerScience, DevOps, Crypto">
    <meta name="theme-color" content="#11a8cd">
    
    <link rel="preload" href="/assets/css/0.styles.0235893d.css" as="style"><link rel="preload" href="/assets/js/app.bd27a176.js" as="script"><link rel="preload" href="/assets/js/3.a94f18cb.js" as="script"><link rel="preload" href="/assets/js/37.75de189e.js" as="script"><link rel="preload" href="/assets/js/131.ccea0513.js" as="script"><link rel="prefetch" href="/assets/js/10.8477e60e.js"><link rel="prefetch" href="/assets/js/100.d632b7b5.js"><link rel="prefetch" href="/assets/js/101.67f81ef7.js"><link rel="prefetch" href="/assets/js/102.b02ba734.js"><link rel="prefetch" href="/assets/js/103.fc4420a1.js"><link rel="prefetch" href="/assets/js/104.205aa3c0.js"><link rel="prefetch" href="/assets/js/105.dce8fdd7.js"><link rel="prefetch" href="/assets/js/106.23c978cd.js"><link rel="prefetch" href="/assets/js/107.6e764533.js"><link rel="prefetch" href="/assets/js/108.526a1af2.js"><link rel="prefetch" href="/assets/js/109.9fd84f61.js"><link rel="prefetch" href="/assets/js/11.5ccd73c1.js"><link rel="prefetch" href="/assets/js/110.98148360.js"><link rel="prefetch" href="/assets/js/111.ba44e204.js"><link rel="prefetch" href="/assets/js/112.32fddec7.js"><link rel="prefetch" href="/assets/js/113.47711acc.js"><link rel="prefetch" href="/assets/js/114.980d5971.js"><link rel="prefetch" href="/assets/js/115.e17d9d17.js"><link rel="prefetch" href="/assets/js/116.4291aaa1.js"><link rel="prefetch" href="/assets/js/117.361a18f7.js"><link rel="prefetch" href="/assets/js/118.080ae515.js"><link rel="prefetch" href="/assets/js/119.4c74f273.js"><link rel="prefetch" href="/assets/js/12.0917bcfd.js"><link rel="prefetch" href="/assets/js/120.2a9148bd.js"><link rel="prefetch" href="/assets/js/121.efbc8f99.js"><link rel="prefetch" href="/assets/js/122.bf801322.js"><link rel="prefetch" href="/assets/js/123.52e9d08d.js"><link rel="prefetch" href="/assets/js/124.26a4a3a3.js"><link rel="prefetch" href="/assets/js/125.79c6590c.js"><link rel="prefetch" href="/assets/js/126.80116bd2.js"><link rel="prefetch" href="/assets/js/127.f715c037.js"><link rel="prefetch" href="/assets/js/128.27713658.js"><link rel="prefetch" href="/assets/js/129.e00ea18f.js"><link rel="prefetch" href="/assets/js/13.79991dac.js"><link rel="prefetch" href="/assets/js/130.a0309434.js"><link rel="prefetch" href="/assets/js/132.fe24fe1a.js"><link rel="prefetch" href="/assets/js/133.74b29371.js"><link rel="prefetch" href="/assets/js/134.d003ed07.js"><link rel="prefetch" href="/assets/js/135.fe83c36d.js"><link rel="prefetch" href="/assets/js/136.69d67f46.js"><link rel="prefetch" href="/assets/js/137.133a9f10.js"><link rel="prefetch" href="/assets/js/138.04917011.js"><link rel="prefetch" href="/assets/js/139.48c97281.js"><link rel="prefetch" href="/assets/js/14.642e027b.js"><link rel="prefetch" href="/assets/js/140.b5ab78db.js"><link rel="prefetch" href="/assets/js/141.7c53c63d.js"><link rel="prefetch" href="/assets/js/142.cccb881b.js"><link rel="prefetch" href="/assets/js/143.3a2aa3a6.js"><link rel="prefetch" href="/assets/js/144.77258c13.js"><link rel="prefetch" href="/assets/js/145.f4bae853.js"><link rel="prefetch" href="/assets/js/146.2c9fd7f2.js"><link rel="prefetch" href="/assets/js/147.bc48b0d9.js"><link rel="prefetch" href="/assets/js/148.a0daddf0.js"><link rel="prefetch" href="/assets/js/149.eda26ecd.js"><link rel="prefetch" href="/assets/js/15.cd7ad790.js"><link rel="prefetch" href="/assets/js/150.4db2594d.js"><link rel="prefetch" href="/assets/js/151.ec35f527.js"><link rel="prefetch" href="/assets/js/152.dedb5b4e.js"><link rel="prefetch" href="/assets/js/153.03e67a84.js"><link rel="prefetch" href="/assets/js/154.b658bb97.js"><link rel="prefetch" href="/assets/js/155.cee22805.js"><link rel="prefetch" href="/assets/js/156.87dfc5bd.js"><link rel="prefetch" href="/assets/js/157.b766b494.js"><link rel="prefetch" href="/assets/js/158.91e9b513.js"><link rel="prefetch" href="/assets/js/159.af913df3.js"><link rel="prefetch" href="/assets/js/16.d2a6dbb3.js"><link rel="prefetch" href="/assets/js/160.8f74e4f1.js"><link rel="prefetch" href="/assets/js/161.2b0fbd54.js"><link rel="prefetch" href="/assets/js/162.fa3a77ea.js"><link rel="prefetch" href="/assets/js/163.463efd8a.js"><link rel="prefetch" href="/assets/js/164.b77b3dc1.js"><link rel="prefetch" href="/assets/js/165.558fdecf.js"><link rel="prefetch" href="/assets/js/166.0a5da9d6.js"><link rel="prefetch" href="/assets/js/167.17c07c29.js"><link rel="prefetch" href="/assets/js/168.620a0ac1.js"><link rel="prefetch" href="/assets/js/169.ec2a7b3d.js"><link rel="prefetch" href="/assets/js/17.4c302f4e.js"><link rel="prefetch" href="/assets/js/170.49131b04.js"><link rel="prefetch" href="/assets/js/18.c31129da.js"><link rel="prefetch" href="/assets/js/19.6d5b93bb.js"><link rel="prefetch" href="/assets/js/2.b6ee3443.js"><link rel="prefetch" href="/assets/js/20.1beb06b3.js"><link rel="prefetch" href="/assets/js/21.b4c74136.js"><link rel="prefetch" href="/assets/js/22.15865a0e.js"><link rel="prefetch" href="/assets/js/23.3cf67982.js"><link rel="prefetch" href="/assets/js/24.9049d940.js"><link rel="prefetch" href="/assets/js/25.3f168cc4.js"><link rel="prefetch" href="/assets/js/26.e9038fcc.js"><link rel="prefetch" href="/assets/js/27.09a2b08e.js"><link rel="prefetch" href="/assets/js/28.9756ca4d.js"><link rel="prefetch" href="/assets/js/29.94ccb989.js"><link rel="prefetch" href="/assets/js/30.353a02c4.js"><link rel="prefetch" href="/assets/js/31.dbdeefb3.js"><link rel="prefetch" href="/assets/js/32.bb70211b.js"><link rel="prefetch" href="/assets/js/33.299ebc94.js"><link rel="prefetch" href="/assets/js/34.401699fd.js"><link rel="prefetch" href="/assets/js/35.4225e8c7.js"><link rel="prefetch" href="/assets/js/36.255c8829.js"><link rel="prefetch" href="/assets/js/38.81eeb179.js"><link rel="prefetch" href="/assets/js/39.3a104414.js"><link rel="prefetch" href="/assets/js/4.9878b90e.js"><link rel="prefetch" href="/assets/js/40.d2b04922.js"><link rel="prefetch" href="/assets/js/41.2e5e1b8e.js"><link rel="prefetch" href="/assets/js/42.108017ef.js"><link rel="prefetch" href="/assets/js/43.3fd17956.js"><link rel="prefetch" href="/assets/js/44.b653b4e3.js"><link rel="prefetch" href="/assets/js/45.7147eeef.js"><link rel="prefetch" href="/assets/js/46.3eb438e7.js"><link rel="prefetch" href="/assets/js/47.cdfd9177.js"><link rel="prefetch" href="/assets/js/48.d7556110.js"><link rel="prefetch" href="/assets/js/49.c1138007.js"><link rel="prefetch" href="/assets/js/5.a99ac687.js"><link rel="prefetch" href="/assets/js/50.12a4ef05.js"><link rel="prefetch" href="/assets/js/51.2b4c86a2.js"><link rel="prefetch" href="/assets/js/52.193ccbe5.js"><link rel="prefetch" href="/assets/js/53.a17c598e.js"><link rel="prefetch" href="/assets/js/54.a82366ee.js"><link rel="prefetch" href="/assets/js/55.77152d87.js"><link rel="prefetch" href="/assets/js/56.44a996cf.js"><link rel="prefetch" href="/assets/js/57.1e686786.js"><link rel="prefetch" href="/assets/js/58.1ff6af32.js"><link rel="prefetch" href="/assets/js/59.3d3d5f85.js"><link rel="prefetch" href="/assets/js/6.f8b187b0.js"><link rel="prefetch" href="/assets/js/60.f4f8142c.js"><link rel="prefetch" href="/assets/js/61.01041b4e.js"><link rel="prefetch" href="/assets/js/62.79bc3aa3.js"><link rel="prefetch" href="/assets/js/63.6217b44f.js"><link rel="prefetch" href="/assets/js/64.b3dfdbdc.js"><link rel="prefetch" href="/assets/js/65.f63b87aa.js"><link rel="prefetch" href="/assets/js/66.43d640bd.js"><link rel="prefetch" href="/assets/js/67.4b87473d.js"><link rel="prefetch" href="/assets/js/68.36a2c347.js"><link rel="prefetch" href="/assets/js/69.643fb43e.js"><link rel="prefetch" href="/assets/js/7.3f85cc50.js"><link rel="prefetch" href="/assets/js/70.033c18af.js"><link rel="prefetch" href="/assets/js/71.5cf1ed3c.js"><link rel="prefetch" href="/assets/js/72.2d3032b5.js"><link rel="prefetch" href="/assets/js/73.e39a774c.js"><link rel="prefetch" href="/assets/js/74.c1bfcdf1.js"><link rel="prefetch" href="/assets/js/75.33202a43.js"><link rel="prefetch" href="/assets/js/76.4434b7b4.js"><link rel="prefetch" href="/assets/js/77.88ebea3f.js"><link rel="prefetch" href="/assets/js/78.77f6a2e9.js"><link rel="prefetch" href="/assets/js/79.0a42f07e.js"><link rel="prefetch" href="/assets/js/8.6845c543.js"><link rel="prefetch" href="/assets/js/80.47d9c4fd.js"><link rel="prefetch" href="/assets/js/81.072a3979.js"><link rel="prefetch" href="/assets/js/82.3259ebfd.js"><link rel="prefetch" href="/assets/js/83.270310b5.js"><link rel="prefetch" href="/assets/js/84.2e0368c9.js"><link rel="prefetch" href="/assets/js/85.a757312b.js"><link rel="prefetch" href="/assets/js/86.ba5d7ea8.js"><link rel="prefetch" href="/assets/js/87.180d1a07.js"><link rel="prefetch" href="/assets/js/88.351d51bc.js"><link rel="prefetch" href="/assets/js/89.d0f5629b.js"><link rel="prefetch" href="/assets/js/9.3351a795.js"><link rel="prefetch" href="/assets/js/90.990cf8ae.js"><link rel="prefetch" href="/assets/js/91.99bfa2df.js"><link rel="prefetch" href="/assets/js/92.d3733be5.js"><link rel="prefetch" href="/assets/js/93.08f327fb.js"><link rel="prefetch" href="/assets/js/94.9f2eef3e.js"><link rel="prefetch" href="/assets/js/95.8ff0375e.js"><link rel="prefetch" href="/assets/js/96.a7997eb8.js"><link rel="prefetch" href="/assets/js/97.a3cb5d37.js"><link rel="prefetch" href="/assets/js/98.caad23c5.js"><link rel="prefetch" href="/assets/js/99.3704a8c0.js">
    <link rel="stylesheet" href="/assets/css/0.styles.0235893d.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu have-body-img"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/img/logo.png" alt="Arkrypto" class="logo"> <span class="site-name can-hide">Arkrypto</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="/cs/" class="nav-link">计算机科学与技术</a></div><div class="nav-item"><a href="/dev/" class="nav-link">开发与运维</a></div><div class="nav-item"><a href="/sec/" class="nav-link">网络与信息安全</a></div><div class="nav-item"><a href="/mine/" class="nav-link">我的</a></div><div class="nav-item"><a href="/archives/" class="nav-link">归档</a></div> <a href="https://github.com/Arkrypto" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar-hover-trigger"></div> <aside class="sidebar" style="display:none;"><div class="blogger"><img src="/img/avatar.png"> <div class="blogger-info"><h3>Arkrypto</h3> <span>就在坚冰还盖着北海的时候，我看到了怒放的梅花</span></div></div> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="/cs/" class="nav-link">计算机科学与技术</a></div><div class="nav-item"><a href="/dev/" class="nav-link">开发与运维</a></div><div class="nav-item"><a href="/sec/" class="nav-link">网络与信息安全</a></div><div class="nav-item"><a href="/mine/" class="nav-link">我的</a></div><div class="nav-item"><a href="/archives/" class="nav-link">归档</a></div> <a href="https://github.com/Arkrypto" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>后端开发</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>运维</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>Linux 基础</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>工具与中间件</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading open"><span>服务部署</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/ceab3a/" class="sidebar-link">Nginx 和 Jenkins</a></li><li><a href="/pages/d7c3d3/" class="sidebar-link">Docker 基础</a></li><li><a href="/pages/b629cf/" aria-current="page" class="active sidebar-link">Docker 和 K8s</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level2"><a href="/pages/b629cf/#镜像构建" class="sidebar-link">镜像构建</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/b629cf/#dockerfile-多阶段构建" class="sidebar-link">Dockerfile 多阶段构建</a></li><li class="sidebar-sub-header level3"><a href="/pages/b629cf/#spring-应用容器化" class="sidebar-link">Spring 应用容器化</a></li><li class="sidebar-sub-header level3"><a href="/pages/b629cf/#docker-compose-编排" class="sidebar-link">Docker-Compose 编排</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/b629cf/#容器逃逸" class="sidebar-link">容器逃逸</a></li><li class="sidebar-sub-header level2"><a href="/pages/b629cf/#k8s-基础" class="sidebar-link">K8s 基础</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/b629cf/#k8s-概述" class="sidebar-link">K8s 概述</a></li><li class="sidebar-sub-header level3"><a href="/pages/b629cf/#k3s-部署监控" class="sidebar-link">K3s 部署监控</a></li></ul></li></ul></li></ul></section></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>前端开发</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-06970110><div class="articleInfo" data-v-06970110><ul class="breadcrumbs" data-v-06970110><li data-v-06970110><a href="/" title="首页" class="iconfont icon-home router-link-active" data-v-06970110></a></li> <li data-v-06970110><a href="/dev/#开发与运维" data-v-06970110>开发与运维</a></li><li data-v-06970110><a href="/dev/#运维" data-v-06970110>运维</a></li><li data-v-06970110><a href="/dev/#服务部署" data-v-06970110>服务部署</a></li></ul> <div class="info" data-v-06970110><div title="作者" class="author iconfont icon-touxiang" data-v-06970110><a href="https://github.com/Arkrypto" target="_blank" title="作者" class="beLink" data-v-06970110>Arkrypto</a></div> <div title="创建时间" class="date iconfont icon-riqi" data-v-06970110><a href="javascript:;" data-v-06970110>2025-5-19</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-title">目录</div> <div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABH1JREFUSA3tVl1oHFUUPmdmd2ltklqbpJDiNnXFmgbFktho7YMPNiJSSZM0+CAYSkUELVhM6YuwIPpgoOKDqOBDC0XE2CQoNtQXBUFTTcCi+Wlh1V2TQExsUzcltd3M9Tt3ZjZzZ2fT+OJTL8yeM+eee757fmeJbq//KQL8X3DUSFOcfr7cRsRtxNQMWueeVzOkaITIGqQHNg5y8+jNW9ldM7A6nTpAjuolUikAwq7CE3WcM2RRDz+XGVgN3FptU/aUSlvq9Pa3iZ1+sgAqJyyAFqkipd9dqiwHF3P65YycLWc/6sqGrvoEoIp6DOFaX5h6+dnfjkWprwqsPk0dUGq5vySwDImC10KxFHgGL1SWoc92O3eVht09qdXNH11I2SsTsJYqMWzihqGMi+A+Garf3BAuuLI5oGlULyNfyB/HYNujwktOfRrMr5t77NmevqaUopx0grnKAyvVpmwUDB4x6FPXuGvYLTDwWsejwgtgkYKPqRJg8SV6xaiZ3ZTppGneS4yfH5/66fZSDHv+QZci/+h5c5UHtpy67JUqGppM0sh0Nc1dW6/N1W5Yoqat8/TU/VnadmdeW2PLLSyh0cvxBs3KbqTmwYPpxN4do/mzE8nEpvX/UMu2Wbp74zUAK5q6WkHns7V0eWkdPbPzd3rxkTGybadYySumVzhcaJFbs5UrEkQ/+CK8gF5dnh/6ciIZ73gwQ927L1IitoxKLXYP3SjYdOrHHfTZhRRlFyrorafPk20B3HPD1y2G3qKZME5Jcf3t/HUC13/8tSd++vqFveMUTwAUxSUFI1QekR1+bIze3D9MF2aq6cPvG72CgnldWCFqyRw3lwH8ZMerjTD9ElRO7Gv44wNpC90aASqGfVlz/Rx17srQ57/UU26hkhQqUB7dBR71WmzQhHUnblGmVOEw0jhbV1n9OlXUDCIRGaNV5Jp43N516fN7JmnTHdfp7Hgy0luO4aMhtkLL8Bi3bUWYvzh5Mn1dTxrL6QmGuRhGL/TiTTxRoEdTszSaq9GR0NGA3KdkOz3hqSV3MIDhQ5IVX/Ivx3umBti2es2h4eZby7x8br1rkf7Mo90AqC8aQ3sJeNzqFRu+vSANAQe3PL7l0HGOAdwDCeZYvNKeoZp1Qfs6Aipndh86HmFRi0LAnEO47wsqM6cdfjh3jBPUzhZy7nvlUfFsamED1VQt6aISHVymXZ/B2aCtIG8AI8xfobj2d3en1wWVhOeHELKmLQ1s211s88comkv4UCwWyF787mJdYXtNfhKAXVqnKTq8QZvGAGGOfaTo5pGZ/PwbUCr5+DPr/1J92JNHr9aOl/F3iI5+O1nfybsGxoimvZ3ViWSluDITw3P37mypheDIPY0tw7+O/5ApbkYw+zpfaUVu32Pi98+defdUhEpZkRFq0aqyNh9FuL9hpYbEm6iwi0z2REd09ZmyENEbuhjDWzKvZXTqKYaBIr3tt5kuPtQBZFvEUwHt60vfCNu41XsksH9Ij1BMMz1Y0OOunHNShFIP5868g5zeXmuLwL9T4b6Q2+KejgAAAABJRU5ErkJggg==">Docker 和 K8s<!----></h1> <!----> <div class="theme-vdoing-content content__default"><h2 id="镜像构建"><a href="#镜像构建" class="header-anchor">#</a> 镜像构建</h2> <h3 id="dockerfile-多阶段构建"><a href="#dockerfile-多阶段构建" class="header-anchor">#</a> Dockerfile 多阶段构建</h3> <p>别忘记我们的核心诉求（或者说，容器的功能）</p> <ul><li>为应用程序提供运行环境</li> <li>隔离运行在主机上不同进程</li></ul> <p>Dockerfile 定义了如何构建一个 Docker 镜像</p> <div class="language-dockerfile line-numbers-mode"><pre class="language-dockerfile"><code><span class="token instruction"><span class="token keyword">FROM</span> golang:1.20</span>
<span class="token instruction"><span class="token keyword">WORKDIR</span> /app</span>
<span class="token instruction"><span class="token keyword">COPY</span> . .</span>
<span class="token instruction"><span class="token keyword">RUN</span> go build -o main .</span>
<span class="token instruction"><span class="token keyword">CMD</span> [<span class="token string">&quot;./main&quot;</span>]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>这个 dockerfile</p> <ol><li>使用官方<code>golang:1.20</code>镜像作为构建环境</li> <li>把所有文件复制到<code>/app</code></li> <li>在容器内构建 Go 可执行文件<code>main</code></li> <li>设置默认执行命令为<code>./main</code></li></ol> <p>在本地执行以下命令来构建和运行镜像</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">docker</span> build <span class="token parameter variable">-t</span> myapp <span class="token builtin class-name">.</span> <span class="token operator">&amp;&amp;</span> <span class="token function">docker</span> run myapp
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>其中</p> <table><thead><tr><th>部分</th> <th>说明</th></tr></thead> <tbody><tr><td><code>docker build</code></td> <td>表示你要构建一个 Docker 镜像</td></tr> <tr><td><code>-t myapp</code></td> <td>给镜像起个名字（tag）叫 <code>myapp</code>，等同于 <code>--tag myapp</code></td></tr> <tr><td><code>.</code></td> <td>表示根据<strong>当前目录</strong>构建上下文（会将此目录的文件发送给 Docker 引擎使用）</td></tr></tbody></table> <p>即：在当前目录下查找<code>Dockerfile</code>，然后构建一个镜像，并命名为<code>myapp</code></p> <p>这样的构建是有问题的：使用了 <strong>构建 + 运行</strong>混合的镜像（未分阶段）</p> <ol><li><code>golang:1.20</code> 镜像很大（约 1GB+），包含编译器、工具链，不适合运行时部署</li> <li>生成的镜像包含了源代码和构建缓存，不干净、不安全</li></ol> <p>就是说，如果像上述做法打包，将一次性将 Go 源码、编译工具链（Go Build）、编译缓存和可执行文件都打包，构建后镜像至少高达 800MB+，这对于部署、安全、传输都很不妙</p> <p>正确的做法是多阶段构建（Multi-stage build）</p> <ul><li>多阶段构建是一种在一个 Dockerfile 中使用多个<code>FROM</code>段落，<strong>用前面的镜像构建产物</strong>，最后用一个<strong>干净的基础镜像</strong>打包最终产物，从而实现“构建和运行分离”</li></ul> <p>多阶段构建：只打包“最终产物”</p> <ul><li>它的核心思想：<strong>用一个镜像“编译”，再用另一个镜像“运行”</strong></li></ul> <p>例如</p> <div class="language-dockerfile line-numbers-mode"><pre class="language-dockerfile"><code><span class="token comment"># === 第一阶段：构建镜像（builder）</span>
<span class="token instruction"><span class="token keyword">FROM</span> golang:1.20 <span class="token keyword">AS</span> builder</span>
<span class="token instruction"><span class="token keyword">WORKDIR</span> /app</span>
<span class="token instruction"><span class="token keyword">COPY</span> go.mod go.sum ./</span>
<span class="token instruction"><span class="token keyword">RUN</span> go mod download</span>
<span class="token instruction"><span class="token keyword">COPY</span> . .</span>
<span class="token instruction"><span class="token keyword">RUN</span> CGO_ENABLED=0 GOOS=linux go build -o main .</span>

<span class="token comment"># === 第二阶段：运行镜像（干净、最小）</span>
<span class="token instruction"><span class="token keyword">FROM</span> alpine:latest</span>
<span class="token instruction"><span class="token keyword">WORKDIR</span> /root/</span>
<span class="token instruction"><span class="token keyword">COPY</span> <span class="token options"><span class="token property">--from</span><span class="token punctuation">=</span><span class="token string">builder</span></span> /app/main .</span>

<span class="token instruction"><span class="token keyword">CMD</span> [<span class="token string">&quot;./main&quot;</span>]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p>第一阶段：构建产物</p> <div class="language-dockerfile line-numbers-mode"><pre class="language-dockerfile"><code><span class="token instruction"><span class="token keyword">FROM</span> golang:1.20 <span class="token keyword">AS</span> builder</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li>用官方带编译器的 Golang 镜像构建可执行文件</li> <li><code>AS builder</code>给这个阶段命个名字，后面可以引用</li></ul> <div class="language-dockerfile line-numbers-mode"><pre class="language-dockerfile"><code>go.mod go.sum ./ &amp;&amp; RUN go mod download
<span class="token instruction"><span class="token keyword">COPY</span> . . &amp;&amp; RUN go build -o main .</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>这是 go 项目的常规构建过程</p> <p>第二阶段：最小运行时镜像</p> <div class="language-dockerfile line-numbers-mode"><pre class="language-dockerfile"><code><span class="token instruction"><span class="token keyword">FROM</span> alpine:latest</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li>超小镜像（仅 5MB 左右）</li> <li>不含 Go 编译器，不含源码，不含构建缓存 —— 非常安全干净</li></ul> <div class="language-dockerfile line-numbers-mode"><pre class="language-dockerfile"><code><span class="token instruction"><span class="token keyword">COPY</span> <span class="token options"><span class="token property">--from</span><span class="token punctuation">=</span><span class="token string">builder</span></span> /app/main .</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li>仅把前面构建出的可执行文件 <code>main</code> 复制过来，其它统统不要</li></ul> <p>这样将获得一个 20MB 左右的运行镜像，用于生产部署，而构建镜像作为临时产物将被丢弃掉，不参与最后的部署</p> <table><thead><tr><th>优点</th> <th>描述</th></tr></thead> <tbody><tr><td>✅ 更小的镜像</td> <td>只包含运行必需文件</td></tr> <tr><td>✅ 更安全</td> <td>去除了构建工具、源码等敏感内容</td></tr> <tr><td>✅ 更快部署</td> <td>镜像传输快，容器启动快</td></tr> <tr><td>✅ 适合 CI/CD</td> <td>用<code>docker build</code>一次构建，产出即部署级镜像</td></tr></tbody></table> <p>在当前目录下测试构建运行</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">docker</span> build <span class="token parameter variable">-t</span> myMultiApp <span class="token builtin class-name">.</span>
<span class="token function">docker</span> run <span class="token parameter variable">--rm</span> myMkultiApp
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>简单来说：多阶段构建 = 构建与运行分离，使用“胖”镜像编译代码，用“瘦”镜像跑服务</p> <h3 id="spring-应用容器化"><a href="#spring-应用容器化" class="header-anchor">#</a> Spring 应用容器化</h3> <p>以一个简单的Spring Boot Web应用程序为例，包含以下特点</p> <ul><li>Spring Boot 3</li> <li>Java 17</li> <li>Maven 构建工具</li> <li>RESTful API 接口</li> <li>标准的项目结构</li></ul> <p>项目结构如下</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>|——src/
|	|—— main/
|	|	|—— java/
|	|	|	|__ cia/arkrypto/demoapp/
|	|	|__ resources/
|	|__ test/
|—— pom.xml
|—— Dockerfile
|__ kubernetes/
	|—— deployment.yaml
	|—— service.yaml
	|__ ingress.yaml
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>验证本地环境</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token function">java</span> <span class="token parameter variable">-version</span>
mvn <span class="token parameter variable">-version</span>
<span class="token function">docker</span> <span class="token parameter variable">--version</span>
kubectl version
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>容器化 Spring 应用：我们需要创建一个 Dockerfile 来构建应用容器，使用多阶段构建来优化最终镜像大小</p> <div class="language-dockerfile line-numbers-mode"><pre class="language-dockerfile"><code><span class="token comment"># 第一阶段：构建应用</span>
<span class="token instruction"><span class="token keyword">FROM</span> maven:3.8-openjdk-17 AS build</span>
<span class="token instruction"><span class="token keyword">WORKDIR</span> /app</span>
<span class="token instruction"><span class="token keyword">COPY</span> pom.xml .</span>
<span class="token instruction"><span class="token keyword">RUN</span> mvn dependency:go-offline -BCOPY src ./srcRUN mvn package -DskipTests</span>

<span class="token comment"># 第二阶段：运行应用</span>
<span class="token instruction"><span class="token keyword">FROM</span> openjdk:17-jre-slim</span>
<span class="token instruction"><span class="token keyword">WORKDIR</span> /app</span>
<span class="token instruction"><span class="token keyword">COPY</span> --from=build /app/target/demoapp-0.1.jar app.jar</span>
<span class="token instruction"><span class="token keyword">EXPOSE</span> 8080</span>
<span class="token instruction"><span class="token keyword">ENTRYPOINT</span> [<span class="token string">&quot;java&quot;</span>, <span class="token string">&quot;-jar&quot;</span>, <span class="token string">&quot;app.jar&quot;</span>]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>和上面多阶段部署的样例一样，这个 Dockerfile 包含两个阶段</p> <ul><li>构建阶段：使用 Maven 构建应用</li> <li>运行阶段：使用精简版 JRE 运行应用</li></ul> <p>构建并测试 Docker 镜像</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token comment"># 构建镜像</span>
<span class="token function">docker</span> build <span class="token parameter variable">-t</span> demoapp:latest <span class="token builtin class-name">.</span>
<span class="token comment"># 测试运行</span>
<span class="token function">docker</span> run <span class="token parameter variable">-p</span> <span class="token number">8080</span>:8080 demoapp:latest
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>OK，这样就好了，当启动镜像后，就可以在本地的 8080 端口访问这个 Spring 应用</p> <ul><li>进一步的，如果有配套的 CI 工具（比如说 Jenkins），就可以将这个镜像 demoapp 推送到对应的服务器上并执行容器启动命令<code>docker run</code>，就完成了一次全自动的打包和部署</li></ul> <h3 id="docker-compose-编排"><a href="#docker-compose-编排" class="header-anchor">#</a> Docker-Compose 编排</h3> <p>Docker-Compose：定义多个 Docker 容器的运行方式</p> <p>docker-compose.yaml</p> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">version</span><span class="token punctuation">:</span> <span class="token string">'3'</span>
<span class="token key atrule">services</span><span class="token punctuation">:</span>
  <span class="token key atrule">app</span><span class="token punctuation">:</span>
    <span class="token key atrule">build</span><span class="token punctuation">:</span> .
    <span class="token key atrule">ports</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token string">&quot;8080:8080&quot;</span>
    <span class="token key atrule">depends_on</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> db
  <span class="token key atrule">db</span><span class="token punctuation">:</span>
    <span class="token key atrule">image</span><span class="token punctuation">:</span> mysql<span class="token punctuation">:</span><span class="token number">8.0</span>
    <span class="token key atrule">environment</span><span class="token punctuation">:</span>
      <span class="token key atrule">MYSQL_ROOT_PASSWORD</span><span class="token punctuation">:</span> <span class="token number">123456</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>上述 docker-compose 包含两个服务</p> <ul><li><code>app</code>: 用当前目录构建的应用容器</li> <li><code>db</code>: 使用 MySQL 8.0 镜像的数据库容器</li></ul> <p>各字段含义</p> <table><thead><tr><th>字段</th> <th>说明</th></tr></thead> <tbody><tr><td><code>version: '3'</code></td> <td>指定 compose 文件版本（v3 通常用于 Docker Engine + Swarm）</td></tr> <tr><td><code>services</code></td> <td>定义所有容器服务</td></tr> <tr><td><code>app.build: .</code></td> <td>当前目录构建（寻找<code>Dockerfile</code>）</td></tr> <tr><td><code>ports: 8080:8080</code></td> <td>本地 8080 映射到容器 8080</td></tr> <tr><td><code>depends_on</code></td> <td>让<code>app</code>在<code>db</code>之后启动（注意：不是等待 DB 可用，仅顺序）</td></tr> <tr><td><code>db.image</code></td> <td>使用官方 MySQL 8.0 镜像</td></tr> <tr><td><code>db.environment</code></td> <td>设置 root 用户密码为<code>example</code></td></tr></tbody></table> <p>在含有<code>Dockerfile</code>和<code>docker-compose.yml</code>的目录运行</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token function">docker-compose</span> up <span class="token parameter variable">--build</span> <span class="token parameter variable">-d</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li><code>docker-compose</code>: 使用 Docker Compose 工具（多容器编排）</li> <li><code>up</code>: 表示启动所有服务</li> <li><code>--build</code>: 表示在启动前先强制重新构建服务镜像</li> <li><code>-d</code>：表示后台运行</li></ul> <p>Docker 将</p> <ol><li>解析 compose 文件</li> <li>找到 Dockerfile 构建 APP 镜像</li> <li>拉取远程镜像（MySQL 8.0）</li> <li>创建网络</li> <li>创建并启动容器</li> <li>日志输出并后台运行</li></ol> <p>注意</p> <p><code>--build</code>将会强制重新构建、拉取镜像，如果不加，默认<strong>不会</strong>重新构建镜像，会直接用上次构建好的本地镜像（只要镜像没删掉，Docker Compose 会复用它）</p> <ul><li>这是 Docker 的“增量构建”和“缓存重用”机制</li></ul> <p>当命令没有加上<code>-d</code>时，将默认为前台运行，即按下 ctrl c 后，将发送<code>SIGINT</code>给所有容器并关闭</p> <p>查看当前容器组状态</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token function">docker-compose</span> <span class="token function">ps</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>停止后台的容器组</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">docker-compose</span> down
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>这会停止并移除容器、网络、默认卷（但不会删除镜像）</p> <p>如需彻底删除</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">docker-compose</span> down <span class="token parameter variable">--volumes</span> <span class="token parameter variable">--rmi</span> all
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="容器逃逸"><a href="#容器逃逸" class="header-anchor">#</a> 容器逃逸</h2> <p>“容器逃逸”（Container Escape）是容器安全中非常核心、也非常危险的一个概念，一句话来说：容器逃逸指攻击者通过某种方式，从容器内部突破隔离机制，进入或控制宿主机（Host OS），进而可能影响其他容器或整个系统</p> <p>容器逃逸的典型方式</p> <p>1️⃣ 内核漏洞</p> <ul><li>容器和宿主机共用 Linux 内核，如果容器里运行的程序触发了内核漏洞，就可能直接提权</li> <li>例子：CVE-2022-0185、Dirty Pipe（CVE-2022-0847）、Dirty Cow（CVE-2016-5195）</li></ul> <p>2️⃣ 特权容器（Privileged Container）</p> <ul><li>如果容器被配置成 <code>--privileged</code> 模式，它几乎拥有宿主机上的所有能力，非常危险</li> <li>如果攻击者控制了这种容器，可以访问设备节点、修改内核模块等，轻松逃逸</li></ul> <p>3️⃣ 挂载宿主机目录：</p> <ul><li>如果宿主机的敏感路径（如 <code>/etc</code>、<code>/var/run/docker.sock</code>）被挂载到容器中，容器内的进程可以直接控制宿主机</li></ul> <p>4️⃣ 容器运行时漏洞（如 Docker、containerd）</p> <ul><li>如果容器运行时本身有漏洞，攻击者可以利用这些缺陷突破隔离</li> <li>例如：runc 早期版本有直接实现容器逃逸的漏洞</li></ul> <p>逃逸的后果</p> <table><thead><tr><th>后果</th> <th>说明</th></tr></thead> <tbody><tr><td>访问主机系统</td> <td>攻击者可读取主机文件、用户信息</td></tr> <tr><td>横向移动</td> <td>攻击者可攻击其他容器或服务</td></tr> <tr><td>控制宿主网络</td> <td>劫持流量，监控通信</td></tr> <tr><td>安装后门</td> <td>实现持续性控制（APT）</td></tr> <tr><td>删除/加密数据</td> <td>类似勒索软件行为</td></tr></tbody></table> <p>如何防止容器逃逸</p> <table><thead><tr><th>防御手段</th> <th>说明</th></tr></thead> <tbody><tr><td>✅ 使用最小权限原则</td> <td>不使用 <code>--privileged</code>，只赋予必要的 <code>capabilities</code></td></tr> <tr><td>✅ 不挂载敏感主机路径</td> <td>如 <code>/var/run/docker.sock</code>、<code>/etc</code></td></tr> <tr><td>✅ 运行非 root 用户</td> <td>尽量使用非 root 账户运行容器</td></tr> <tr><td>✅ 使用内核安全模块</td> <td>如 AppArmor、SELinux、Seccomp，限制系统调用</td></tr> <tr><td>✅ 隔离运行时</td> <td>用 gVisor、Kata Containers 等沙箱运行技术增强隔离性</td></tr> <tr><td>✅ 定期更新内核与 Docker 版本</td> <td>修复已知漏洞</td></tr> <tr><td>✅ 使用容器扫描工具</td> <td>如 Trivy、Aqua、Sysdig 识别潜在风险</td></tr></tbody></table> <p>容器逃逸 = 容器“突破封锁”访问主机系统，是一种非常严重的安全风险，尤其是在多租户平台（如 Kubernetes 集群）中</p> <ul><li>部署生产容器时，安全配置必须严格审查</li></ul> <h2 id="k8s-基础"><a href="#k8s-基础" class="header-anchor">#</a> K8s 基础</h2> <p>Kubernetes 是用于自动部署、扩展和容器化应用程序的开源系统</p> <h3 id="k8s-概述"><a href="#k8s-概述" class="header-anchor">#</a> K8s 概述</h3> <p>我们回顾一下，Docker 的三个主要概念和核心目的</p> <ul><li>三个概念：容器（运行在虚拟机上的进程）、镜像（容器的”源码“）、仓库（镜像库）</li> <li>核心目的：为应用程序提供运行环境，并隔离运行在主机上不同进程</li></ul> <p>当使用的容器服务多了，面临的访问量增大以后，或者是在分布式架构下涉及到复杂的相互调用，容器间的编排显得尤为重要，错误的编排调用策略将导致一片混乱</p> <p>于是我们需要一种工具把这些容器统一的管理起来，需要实现对这些个容器的自动部署、扩展和管理，也就是所谓的容器编排，K8s 正是这样一个自动化容器编排的系统</p> <p>其优点如下</p> <ul><li>可移植性、灵活性和可扩展性</li> <li>支持命令式/声明式配置和自动化</li> <li>CNCF 的一个毕业项目，生态系统庞大</li></ul> <h3 id="k3s-部署监控"><a href="#k3s-部署监控" class="header-anchor">#</a> K3s 部署监控</h3> <p>K3s 是 Rancher 实验室的一个轻量级 Kubernetes 发行版，是由 CNCF 完全认证的 Kubernetes 产品，适合在资源受限的硬件上使用（例如 IoT 设备），它保留了 Kubernetes 的核心功能，但通过去除一些不必要的组件（如云服务提供商集成）来减小二进制文件的大小（K3s 的基础二进制包大小不到 100MB）</p> <p>需要注意的是轻量级带来的功能缺失，如</p> <ul><li>K3s 目前不支持在主节点上运行除 SQLite 以外的任何其他数据库</li> <li>不支持多个主节点</li></ul> <p>故而在选择默认容器编排器时，定义需求和目标非常重要</p> <p>部署监控流程</p> <ol><li>容器化：使用<code>Docker</code>构建 Spring 微服务；使用<code>Helm</code>部署微服务</li> <li>K3s 基础：安装 K3s，创建 Deployment、Service、Ingress</li> <li>应用部署：依次 apply deployment、service、ingress，并进行部署验证 kubectl get</li> <li>验证和测试：检查应用状态、访问应用</li> <li>服务监控：Prometheus + Grafana 进行监控，Loki + Promtail 进行日志采集</li></ol> <p>快速安装</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token function">curl</span> <span class="token parameter variable">-sfL</span> https://get.k3s.io <span class="token operator">|</span> <span class="token function">sh</span> -
<span class="token comment"># 检查就绪代码</span>
takes maybe <span class="token number">30</span> seconds
k3s kubectl get <span class="token function">node</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>三个配置文件</p> <ul><li>deployment.yaml</li> <li>service.yaml</li> <li>ingress.yaml</li></ul> <p>常见问题及解决方案</p> <p>Pod 启动失败</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code>kubectl describe pod <span class="token operator">&lt;</span>pod-name<span class="token operator">&gt;</span>
kubectl logs <span class="token operator">&lt;</span>pod-name<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>服务无法访问</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code>kubectl get endpoints demoapp
kubectl describe <span class="token function">service</span> demoapp
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>Ingress 问题</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code>kubectl describe ingress demoapp
kubectl get events
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></div></div> <!----> <div class="page-edit"><!----> <!----> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">2025/06/28, 15:34:23</span></div></div> <div class="page-nav-wapper"><div class="page-nav-centre-wrap"><a href="/pages/d7c3d3/" class="page-nav-centre page-nav-centre-prev"><div class="tooltip">Docker 基础</div></a> <a href="/pages/e12125/" class="page-nav-centre page-nav-centre-next"><div class="tooltip">HTML</div></a></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/pages/d7c3d3/" class="prev">Docker 基础</a></span> <span class="next"><a href="/pages/e12125/">HTML</a>→
      </span></p></div></div></div> <div class="article-list"><div class="article-title"><a href="/archives/" class="iconfont icon-bi">最近更新</a></div> <div class="article-wrapper"><dl><dd>01</dd> <dt><a href="/pages/706b77/"><div>
            先进数据库技术（二）
            <!----></div></a> <span class="date">6-20</span></dt></dl><dl><dd>02</dd> <dt><a href="/pages/aecc6a/"><div>
            Java 静态代码分析
            <!----></div></a> <span class="date">6-19</span></dt></dl><dl><dd>03</dd> <dt><a href="/pages/2ce9d5/"><div>
            基于可擦除签名的权限切换协议
            <!----></div></a> <span class="date">6-5</span></dt></dl> <dl><dd></dd> <dt><a href="/archives/" class="more">更多文章&gt;</a></dt></dl></div></div></main></div> <div class="footer"><div class="icons"><a href="mailto:Arkrypto@qq.com" title="邮件" target="_blank" class="iconfont icon-youjian"></a><a href="https://github.com/Arkrypto" title="GitHub" target="_blank" class="iconfont icon-github"></a><a href="https://music.163.com/#/my/m/music/playlist?id=5123040741" title="音乐" target="_blank" class="iconfont icon-erji"></a></div> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="本站主题">Vdoing</a> 
    | Copyright © 2021-2025
    <span>Arkrypto | <a href="https://github.com/Arkrypto/Arkrypto.github.io/blob/main/LICENSE" target="_blank">MIT License</a></span></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          跟随系统
        </li><li class="iconfont icon-rijianmoshi">
          浅色模式
        </li><li class="iconfont icon-yejianmoshi">
          深色模式
        </li><li class="iconfont icon-yuedu">
          阅读模式
        </li></ul></div></div> <div class="body-bg" style="background:url() center center / cover no-repeat;opacity:0.5;"></div> <!----> <!----></div><div class="global-ui"><div class="reco-bgm-panel" data-v-b1d3339e><audio id="bgm" src="/song/The Sun Also Rises.mp3" data-v-b1d3339e></audio> <div class="reco-float-box" style="bottom:10px;z-index:999999;background-color:blackcadetblue;display:none;" data-v-b1d3339e data-v-41bcba48 data-v-b1d3339e><img src="/img/logo.png" data-v-b1d3339e></div> <div class="reco-bgm-box" style="left:10px;bottom:10px;z-index:999999;" data-v-b1d3339e data-v-41bcba48 data-v-b1d3339e><div class="reco-bgm-cover" style="background-image:url(/img/logo.png);" data-v-b1d3339e><div class="mini-operation" style="display:none;" data-v-b1d3339e><i class="reco-bgm reco-bgm-pause" style="display:none;" data-v-b1d3339e></i> <i class="reco-bgm reco-bgm-play" style="display:none;" data-v-b1d3339e></i></div> <div class="falut-message" style="display:none;" data-v-b1d3339e>
          播放失败
        </div></div> <div class="reco-bgm-info" data-v-b1d3339e data-v-41bcba48 data-v-b1d3339e><div class="info-box" data-v-b1d3339e><i class="reco-bgm reco-bgm-music music" data-v-b1d3339e></i>太阳照常升起</div> <div class="info-box" data-v-b1d3339e><i class="reco-bgm reco-bgm-artist" data-v-b1d3339e></i>久石譲</div> <div class="reco-bgm-progress" data-v-b1d3339e><div class="progress-bar" data-v-b1d3339e><div class="bar" data-v-b1d3339e></div></div></div> <div class="reco-bgm-operation" data-v-b1d3339e><i class="reco-bgm reco-bgm-last last" data-v-b1d3339e></i> <i class="reco-bgm reco-bgm-pause pause" style="display:none;" data-v-b1d3339e></i> <i class="reco-bgm reco-bgm-play play" data-v-b1d3339e></i> <i class="reco-bgm reco-bgm-next next" data-v-b1d3339e></i> <i class="reco-bgm reco-bgm-volume1 volume" data-v-b1d3339e></i> <i class="reco-bgm reco-bgm-mute mute" style="display:none;" data-v-b1d3339e></i> <div class="volume-bar" data-v-b1d3339e><div class="bar" data-v-b1d3339e></div></div></div></div> <div class="reco-bgm-left-box" data-v-b1d3339e data-v-41bcba48 data-v-b1d3339e><i class="reco-bgm reco-bgm-left" data-v-b1d3339e></i></div></div></div></div></div>
    <script src="/assets/js/app.bd27a176.js" defer></script><script src="/assets/js/3.a94f18cb.js" defer></script><script src="/assets/js/37.75de189e.js" defer></script><script src="/assets/js/131.ccea0513.js" defer></script>
  </body>
</html>
