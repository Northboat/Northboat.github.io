<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>词法和语法分析器设计 | Arkrypto</title>
    <meta name="generator" content="VuePress 1.9.9">
    <link rel="icon" href="/img/favicon.ico">
    <link rel="stylesheet" href="https://at.alicdn.com/t/font_3129839_xft6cqs5gc.css">
    <noscript><meta http-equiv="refresh" content="0; url=https://www.youngkbt.cn/noscript/"><style>.theme-vdoing-content { display:none }</noscript>
    <meta name="description" content="My Wiki">
    <meta name="keywords" content="Arkrypto, ComputerScience, DevOps, Crypto">
    <meta name="theme-color" content="#11a8cd">
    
    <link rel="preload" href="/assets/css/0.styles.0235893d.css" as="style"><link rel="preload" href="/assets/js/app.2e02f8b2.js" as="script"><link rel="preload" href="/assets/js/3.b20caba6.js" as="script"><link rel="preload" href="/assets/js/37.5295b891.js" as="script"><link rel="preload" href="/assets/js/120.25359a70.js" as="script"><link rel="prefetch" href="/assets/js/10.5079b5e3.js"><link rel="prefetch" href="/assets/js/100.3c02d2ce.js"><link rel="prefetch" href="/assets/js/101.ee5e45ec.js"><link rel="prefetch" href="/assets/js/102.2109e68a.js"><link rel="prefetch" href="/assets/js/103.379e512d.js"><link rel="prefetch" href="/assets/js/104.8c768a21.js"><link rel="prefetch" href="/assets/js/105.24a4b586.js"><link rel="prefetch" href="/assets/js/106.fcc1c75c.js"><link rel="prefetch" href="/assets/js/107.291f5f0f.js"><link rel="prefetch" href="/assets/js/108.cb896b1c.js"><link rel="prefetch" href="/assets/js/109.b6069c57.js"><link rel="prefetch" href="/assets/js/11.267836da.js"><link rel="prefetch" href="/assets/js/110.d013dbc4.js"><link rel="prefetch" href="/assets/js/111.b3b4e721.js"><link rel="prefetch" href="/assets/js/112.2f93883e.js"><link rel="prefetch" href="/assets/js/113.47711acc.js"><link rel="prefetch" href="/assets/js/114.a12bf83d.js"><link rel="prefetch" href="/assets/js/115.e17d9d17.js"><link rel="prefetch" href="/assets/js/116.61361160.js"><link rel="prefetch" href="/assets/js/117.4dc1c31a.js"><link rel="prefetch" href="/assets/js/118.f0f65bd6.js"><link rel="prefetch" href="/assets/js/119.4c74f273.js"><link rel="prefetch" href="/assets/js/12.229dd419.js"><link rel="prefetch" href="/assets/js/121.40cc62dd.js"><link rel="prefetch" href="/assets/js/122.e468919b.js"><link rel="prefetch" href="/assets/js/123.52e9d08d.js"><link rel="prefetch" href="/assets/js/124.65759c8e.js"><link rel="prefetch" href="/assets/js/125.79c6590c.js"><link rel="prefetch" href="/assets/js/126.30ecc7be.js"><link rel="prefetch" href="/assets/js/127.e49c7110.js"><link rel="prefetch" href="/assets/js/128.eff25920.js"><link rel="prefetch" href="/assets/js/129.a2c947b9.js"><link rel="prefetch" href="/assets/js/13.896438d6.js"><link rel="prefetch" href="/assets/js/130.098882eb.js"><link rel="prefetch" href="/assets/js/131.f609e199.js"><link rel="prefetch" href="/assets/js/132.f5a5afa6.js"><link rel="prefetch" href="/assets/js/133.8a32dd37.js"><link rel="prefetch" href="/assets/js/134.8babebd1.js"><link rel="prefetch" href="/assets/js/135.845e0d17.js"><link rel="prefetch" href="/assets/js/136.7fc593d8.js"><link rel="prefetch" href="/assets/js/137.a7af845d.js"><link rel="prefetch" href="/assets/js/138.b1e9446d.js"><link rel="prefetch" href="/assets/js/139.48c97281.js"><link rel="prefetch" href="/assets/js/14.d0a6cea4.js"><link rel="prefetch" href="/assets/js/140.b5ab78db.js"><link rel="prefetch" href="/assets/js/141.d6be93b9.js"><link rel="prefetch" href="/assets/js/142.963b83a1.js"><link rel="prefetch" href="/assets/js/143.9b03894e.js"><link rel="prefetch" href="/assets/js/144.77258c13.js"><link rel="prefetch" href="/assets/js/145.95e03f92.js"><link rel="prefetch" href="/assets/js/146.2c9fd7f2.js"><link rel="prefetch" href="/assets/js/147.bc48b0d9.js"><link rel="prefetch" href="/assets/js/148.6272922d.js"><link rel="prefetch" href="/assets/js/149.bb6c9192.js"><link rel="prefetch" href="/assets/js/15.becd7f50.js"><link rel="prefetch" href="/assets/js/150.a55bd4a4.js"><link rel="prefetch" href="/assets/js/151.b3f65afb.js"><link rel="prefetch" href="/assets/js/152.8dc70ff8.js"><link rel="prefetch" href="/assets/js/153.eb831c35.js"><link rel="prefetch" href="/assets/js/154.15a547b2.js"><link rel="prefetch" href="/assets/js/155.f9170817.js"><link rel="prefetch" href="/assets/js/156.d6c316ce.js"><link rel="prefetch" href="/assets/js/157.5f351759.js"><link rel="prefetch" href="/assets/js/158.2c3c1b22.js"><link rel="prefetch" href="/assets/js/159.f11c56f2.js"><link rel="prefetch" href="/assets/js/16.741913a3.js"><link rel="prefetch" href="/assets/js/160.d041e450.js"><link rel="prefetch" href="/assets/js/161.80be93a6.js"><link rel="prefetch" href="/assets/js/162.4c01c861.js"><link rel="prefetch" href="/assets/js/163.84901d3a.js"><link rel="prefetch" href="/assets/js/164.13df63cf.js"><link rel="prefetch" href="/assets/js/165.7d22e8d4.js"><link rel="prefetch" href="/assets/js/166.6d0e4004.js"><link rel="prefetch" href="/assets/js/167.3d0fe2e9.js"><link rel="prefetch" href="/assets/js/168.620a0ac1.js"><link rel="prefetch" href="/assets/js/169.84bbc524.js"><link rel="prefetch" href="/assets/js/17.75cc88a9.js"><link rel="prefetch" href="/assets/js/170.9a5d0291.js"><link rel="prefetch" href="/assets/js/18.c31129da.js"><link rel="prefetch" href="/assets/js/19.8e37e6b1.js"><link rel="prefetch" href="/assets/js/2.dd969d6a.js"><link rel="prefetch" href="/assets/js/20.6f62978c.js"><link rel="prefetch" href="/assets/js/21.fe2bdcea.js"><link rel="prefetch" href="/assets/js/22.22c63fab.js"><link rel="prefetch" href="/assets/js/23.f8356826.js"><link rel="prefetch" href="/assets/js/24.6fe53e86.js"><link rel="prefetch" href="/assets/js/25.b3ed685c.js"><link rel="prefetch" href="/assets/js/26.f0c2bbe1.js"><link rel="prefetch" href="/assets/js/27.1b592980.js"><link rel="prefetch" href="/assets/js/28.faf057f4.js"><link rel="prefetch" href="/assets/js/29.08ae2d95.js"><link rel="prefetch" href="/assets/js/30.8b1128c6.js"><link rel="prefetch" href="/assets/js/31.31f39c73.js"><link rel="prefetch" href="/assets/js/32.bd0dbc35.js"><link rel="prefetch" href="/assets/js/33.3de3e440.js"><link rel="prefetch" href="/assets/js/34.c82829c7.js"><link rel="prefetch" href="/assets/js/35.a92f220f.js"><link rel="prefetch" href="/assets/js/36.6fab3e63.js"><link rel="prefetch" href="/assets/js/38.157cd552.js"><link rel="prefetch" href="/assets/js/39.1a328496.js"><link rel="prefetch" href="/assets/js/4.7f226d3e.js"><link rel="prefetch" href="/assets/js/40.a738489e.js"><link rel="prefetch" href="/assets/js/41.91569636.js"><link rel="prefetch" href="/assets/js/42.9100ebee.js"><link rel="prefetch" href="/assets/js/43.d03ff42e.js"><link rel="prefetch" href="/assets/js/44.ecc457a0.js"><link rel="prefetch" href="/assets/js/45.b2b92772.js"><link rel="prefetch" href="/assets/js/46.4052c12e.js"><link rel="prefetch" href="/assets/js/47.99c56e51.js"><link rel="prefetch" href="/assets/js/48.97054298.js"><link rel="prefetch" href="/assets/js/49.ae5a0f21.js"><link rel="prefetch" href="/assets/js/5.d56fe4c6.js"><link rel="prefetch" href="/assets/js/50.459bd6ef.js"><link rel="prefetch" href="/assets/js/51.bc546ae8.js"><link rel="prefetch" href="/assets/js/52.47277e72.js"><link rel="prefetch" href="/assets/js/53.ccddd157.js"><link rel="prefetch" href="/assets/js/54.16b0f086.js"><link rel="prefetch" href="/assets/js/55.6c53d234.js"><link rel="prefetch" href="/assets/js/56.ce2f8e35.js"><link rel="prefetch" href="/assets/js/57.f5a14377.js"><link rel="prefetch" href="/assets/js/58.0fe2455b.js"><link rel="prefetch" href="/assets/js/59.e62ae15c.js"><link rel="prefetch" href="/assets/js/6.9e96e6aa.js"><link rel="prefetch" href="/assets/js/60.4c907fc1.js"><link rel="prefetch" href="/assets/js/61.f748ae09.js"><link rel="prefetch" href="/assets/js/62.ed67074f.js"><link rel="prefetch" href="/assets/js/63.ea0b3a49.js"><link rel="prefetch" href="/assets/js/64.939f9e06.js"><link rel="prefetch" href="/assets/js/65.e23880a8.js"><link rel="prefetch" href="/assets/js/66.91404bf5.js"><link rel="prefetch" href="/assets/js/67.345e5976.js"><link rel="prefetch" href="/assets/js/68.65c9bf95.js"><link rel="prefetch" href="/assets/js/69.4b60b842.js"><link rel="prefetch" href="/assets/js/7.5f1d5c5a.js"><link rel="prefetch" href="/assets/js/70.f84f7690.js"><link rel="prefetch" href="/assets/js/71.86ada907.js"><link rel="prefetch" href="/assets/js/72.3557f777.js"><link rel="prefetch" href="/assets/js/73.59c92e1e.js"><link rel="prefetch" href="/assets/js/74.1946b7e9.js"><link rel="prefetch" href="/assets/js/75.b24e0b82.js"><link rel="prefetch" href="/assets/js/76.3492c71c.js"><link rel="prefetch" href="/assets/js/77.a1dfda59.js"><link rel="prefetch" href="/assets/js/78.f644573b.js"><link rel="prefetch" href="/assets/js/79.c39a68ee.js"><link rel="prefetch" href="/assets/js/8.36289187.js"><link rel="prefetch" href="/assets/js/80.7d7fc899.js"><link rel="prefetch" href="/assets/js/81.06e14cd1.js"><link rel="prefetch" href="/assets/js/82.1f8fa7b6.js"><link rel="prefetch" href="/assets/js/83.04424930.js"><link rel="prefetch" href="/assets/js/84.b5c13c82.js"><link rel="prefetch" href="/assets/js/85.19ae9272.js"><link rel="prefetch" href="/assets/js/86.0090d435.js"><link rel="prefetch" href="/assets/js/87.758a1919.js"><link rel="prefetch" href="/assets/js/88.3a41a9a1.js"><link rel="prefetch" href="/assets/js/89.c9ea4435.js"><link rel="prefetch" href="/assets/js/9.f4fb8cc5.js"><link rel="prefetch" href="/assets/js/90.0c2edc78.js"><link rel="prefetch" href="/assets/js/91.3bd5c1c8.js"><link rel="prefetch" href="/assets/js/92.1a045095.js"><link rel="prefetch" href="/assets/js/93.209ee79f.js"><link rel="prefetch" href="/assets/js/94.cfbeb8d4.js"><link rel="prefetch" href="/assets/js/95.ff0e8f6b.js"><link rel="prefetch" href="/assets/js/96.7146e1c8.js"><link rel="prefetch" href="/assets/js/97.d9416ac1.js"><link rel="prefetch" href="/assets/js/98.8ddf3b81.js"><link rel="prefetch" href="/assets/js/99.5132fd66.js">
    <link rel="stylesheet" href="/assets/css/0.styles.0235893d.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu have-body-img"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/img/logo.png" alt="Arkrypto" class="logo"> <span class="site-name can-hide">Arkrypto</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="/cs/" class="nav-link">计算机科学与技术</a></div><div class="nav-item"><a href="/dev/" class="nav-link">开发与运维</a></div><div class="nav-item"><a href="/sec/" class="nav-link">网络与信息安全</a></div><div class="nav-item"><a href="/mine/" class="nav-link">我的</a></div><div class="nav-item"><a href="/archives/" class="nav-link">归档</a></div> <a href="https://github.com/Arkrypto" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar-hover-trigger"></div> <aside class="sidebar" style="display:none;"><div class="blogger"><img src="/img/avatar.png"> <div class="blogger-info"><h3>Arkrypto</h3> <span>就在坚冰还盖着北海的时候，我看到了怒放的梅花</span></div></div> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="/cs/" class="nav-link">计算机科学与技术</a></div><div class="nav-item"><a href="/dev/" class="nav-link">开发与运维</a></div><div class="nav-item"><a href="/sec/" class="nav-link">网络与信息安全</a></div><div class="nav-item"><a href="/mine/" class="nav-link">我的</a></div><div class="nav-item"><a href="/archives/" class="nav-link">归档</a></div> <a href="https://github.com/Arkrypto" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>数据结构与算法</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>组成原理</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>计网与操作系统</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>计算机网络基础</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>操作系统基础</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading open"><span>汇编程序设计与编译原理</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/64a0ac/" class="sidebar-link">汇编语言基础</a></li><li><a href="/pages/d08784/" class="sidebar-link">汇编程序设计（一）</a></li><li><a href="/pages/c3f55e/" class="sidebar-link">汇编程序设计（二）</a></li><li><a href="/pages/e2dfea/" class="sidebar-link">编译原理基础</a></li><li><a href="/pages/c78d5b/" aria-current="page" class="active sidebar-link">词法和语法分析器设计</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level2"><a href="/pages/c78d5b/#词法分析器-lexer" class="sidebar-link">词法分析器 Lexer</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/c78d5b/#flex-环境安装" class="sidebar-link">Flex 环境安装</a></li><li class="sidebar-sub-header level3"><a href="/pages/c78d5b/#flex-文件规则" class="sidebar-link">Flex 文件规则</a></li><li class="sidebar-sub-header level3"><a href="/pages/c78d5b/#词法分析器规则编写" class="sidebar-link">词法分析器规则编写</a></li><li class="sidebar-sub-header level3"><a href="/pages/c78d5b/#编译运行" class="sidebar-link">编译运行</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/c78d5b/#flex-bison-实现计算器" class="sidebar-link">Flex/Bison 实现计算器</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/c78d5b/#词法定义" class="sidebar-link">词法定义</a></li><li class="sidebar-sub-header level3"><a href="/pages/c78d5b/#文法定义" class="sidebar-link">文法定义</a></li><li class="sidebar-sub-header level3"><a href="/pages/c78d5b/#联合编译" class="sidebar-link">联合编译</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/c78d5b/#语法分析器-parser" class="sidebar-link">语法分析器 Parser</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/c78d5b/#文法定义-2" class="sidebar-link">文法定义</a></li><li class="sidebar-sub-header level3"><a href="/pages/c78d5b/#语法分析器" class="sidebar-link">语法分析器</a></li><li class="sidebar-sub-header level3"><a href="/pages/c78d5b/#暴力破解" class="sidebar-link">暴力破解</a></li></ul></li></ul></li><li><a href="/pages/cf1664/" class="sidebar-link">基于 C 的 Lisp 编译器</a></li></ul></section></li></ul></section></li></ul> </aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-06970110><div class="articleInfo" data-v-06970110><ul class="breadcrumbs" data-v-06970110><li data-v-06970110><a href="/" title="首页" class="iconfont icon-home router-link-active" data-v-06970110></a></li> <li data-v-06970110><a href="/cs/#计算机科学与技术" data-v-06970110>计算机科学与技术</a></li><li data-v-06970110><a href="/cs/#计网与操作系统" data-v-06970110>计网与操作系统</a></li><li data-v-06970110><a href="/cs/#汇编程序设计与编译原理" data-v-06970110>汇编程序设计与编译原理</a></li></ul> <div class="info" data-v-06970110><div title="作者" class="author iconfont icon-touxiang" data-v-06970110><a href="https://github.com/Arkrypto" target="_blank" title="作者" class="beLink" data-v-06970110>Arkrypto</a></div> <div title="创建时间" class="date iconfont icon-riqi" data-v-06970110><a href="javascript:;" data-v-06970110>2022-10-26</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-title">目录</div> <div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABKFJREFUSA3tVl1oFVcQnrMbrak3QUgkya1akpJYcrUtIqW1JvFBE9LiQ5v6JmJpolbMg32rVrhgoYK0QiMY6i9Y6EMaW5D+xFJaTYItIuK2Kr3+BJNwkxBj05sQY3b3nM6cs2dv9t7NT/vQJw/sndk5M/PNzJkzewGerP+pAmy+ON8lLzUJgA8ZYxYIYZmGYRnctDaWvJJAmTtfP1pvXsBCCPP8QFcCaRkZYACgDZFO4stNIcBCajEOlmmC9XpJ9bAGCaPaPmzPl32dvLSVu3BWCTQs0XQQ6g0DYgwLIoAZbBCdW/i+781o1VVlm/410mw4h06Y7bIPHNyWDyL4FHkX03Q8SrzNhZTZriieckWt7cL6MM85YcLpsi/7O9/iXFT6MswI0DmmpkSaJ0qLxFIm3+i1THHB3zmBH3PYx9CcykcLOeQVVa7QtdxTgQgEleX2AjHYfwA+2ddV77ruGoJUbhGDI09YSNXyMpUt5ylOzxgbUmtOp7NmbNt8v3arjTBfYELmLUV+M+nSawNNAUqpT3ClJWg5I3BLT+cGW/DXNGCa6tx1aakCGEigArTn4TDIPdrXXYKCZNrHLMCOEPvHBlLQ99s9eHB7EB6NTki73CVPQ2F5MSx/uRQixfmq7rK0wYD8w8E905bnPDfwoWs/rfv93NWN/ZfvwsLIU7A09gxECyISeGJkHAau98L97tuw7NXnoPyNF8FcYGLGKsOs0mN3OEyec9esGW/ZEl945dTP34wlR2FZVQWU1q0Cw8Tr7p+hgLLNL0FPxx/Q35mA8aEUrH6nCgwEl0tn7wUiZYJnNRh6DK4UH/k0lfyrsBKdPVv/AriGIQcEDQZ65LBAGe2Rzui9Ybjz7XUppz1/uKBbyVPGkN3ZAeC6hr0x7Nr38N5+EqkoOm17xpoqR9ohQF55ERSvr4Dkr3chNfC3DMzGJlNBElW8w9nsGQvhNGIzDkXzCg8cLK951xHsFBlTJspJNi3ZFIMF2AeDV3q8DNOB+YHi6QTrChDIWDBRi5U5f+ZMfJLu3ccrqxtdxk4SKH336LFxSmkqefwU5T8fhdSdQf9IVKD6aNiwI/hnmcAZ91isYMJIaCUCx9W098+LgruikeTqzqqxKPUwqJyCPJiyemVVZBOijDGjD38Os0jOiSPL1z3SPjXNANbiNPXAdzTfukjjuknNBbyz3nwgTd3AVFqUJ5hpHlq9MveLnWwttUfoygBmvVjuikxND3znrhsELnZk7k+OjIGxeNEkomyLVta0xxn+HZhjBc4YZ/AFjHjz9u3xRZl2BN4aq9nFwWh16IrQ1aHHEd3j1+4/dB9OtH4e29A2H1DyHQRmOSfQZ1Fy7MHBTGB6J/Djq6p3OxyO2cB+4Car7v/o3GXgfAkj23+x9ID1Teoamo/SXcbvSf2PX7Vc8DdCmE1vN9di+32P9/5YR3vLnhCVGUWBjEkr3yh4H8v9CzmsbdhzOKzsJKM90iFdaTMjRPhGVsakRvOaRidljo6H6G7j+ctrJpsP+4COhDIl0La2+FS4+5mlocBaXY5QnGZysIBYoeSsl5qQzrSj/cgNrfuEzlWBfwA+EjrZyWUvpAAAAABJRU5ErkJggg==">词法和语法分析器设计<!----></h1> <!----> <div class="theme-vdoing-content content__default"><h2 id="词法分析器-lexer"><a href="#词法分析器-lexer" class="header-anchor">#</a> 词法分析器 Lexer</h2> <p>编译原理实验，操作系统：manjaro</p> <h3 id="flex-环境安装"><a href="#flex-环境安装" class="header-anchor">#</a> Flex 环境安装</h3> <p>下载 flex、bison</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>yay <span class="token parameter variable">-S</span> flex bison
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>下载 gcc</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>yay <span class="token parameter variable">-S</span> gcc
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>查看版本</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>flex <span class="token parameter variable">--version</span>
flex <span class="token number">2.6</span>.4

gcc <span class="token parameter variable">--version</span>
gcc <span class="token punctuation">(</span>GCC<span class="token punctuation">)</span> <span class="token number">12.2</span>.0
Copyright © <span class="token number">2022</span> Free Software Foundation, Inc.
本程序是自由软件；请参看源代码的版权声明。本软件没有任何担保；
包括没有适销性和某一专用目的下的适用性担保
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>flex 基本使用：输入<code>.l</code>文件，自动生成<code>lex.yy.c</code>及 debug 等日志文件，<code>lex.yy.c</code>即为所需词法分析器的 c 源代码</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>flex exam.l
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>编译<code>lex.yy.c</code>，-o 参数指定生成文件名称</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>gcc <span class="token parameter variable">-o</span> exam lex.yy.c
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>flex 实现词法分析器，见 lexer 文件夹，识别以下规则</p> <table><thead><tr><th>单词名称</th> <th>类别码</th> <th>单词名称</th> <th>类别码</th> <th>单词名称</th> <th>类别码</th> <th>单词名称</th> <th>类别码</th></tr></thead> <tbody><tr><td>标识符</td> <td>IDENFR</td> <td>if</td> <td>IFTK</td> <td>-</td> <td>MINU</td> <td>=</td> <td>ASSIGN</td></tr> <tr><td>整数</td> <td>INTCON</td> <td>else</td> <td>ELSETK</td> <td>*</td> <td>MULT</td> <td>;</td> <td>SEMICN</td></tr> <tr><td>字符</td> <td>CHARCON</td> <td>do</td> <td>DOTK</td> <td>/</td> <td>DIV</td> <td>,</td> <td>COMMA</td></tr> <tr><td>字符串</td> <td>STRCON</td> <td>while</td> <td>WHILETK</td> <td>&lt;</td> <td>LSS</td> <td>(</td> <td>LPARENT</td></tr> <tr><td>const</td> <td>CONSTTK</td> <td>for</td> <td>FORTK</td> <td>&lt;=</td> <td>LEQ</td> <td>)</td> <td>RPARENT</td></tr> <tr><td>int</td> <td>INTTK</td> <td>scanf</td> <td>S CANFTK</td> <td>&gt;</td> <td>GRE</td> <td>[</td> <td>LBRACK</td></tr> <tr><td>char</td> <td>CHARTK</td> <td>printf</td> <td>PRINTFTK</td> <td>&gt;=</td> <td>GEQ</td> <td>]</td> <td>RBRACK</td></tr> <tr><td>void</td> <td>VOIDTK</td> <td>return</td> <td>RETURNTK</td> <td>==</td> <td>EQL</td> <td>{</td> <td>LBRACE</td></tr> <tr><td>main</td> <td>MAINTK</td> <td>+</td> <td>PLUS</td> <td>!=</td> <td>NEQ</td> <td>}</td> <td>RBRACE</td></tr></tbody></table> <h3 id="flex-文件规则"><a href="#flex-文件规则" class="header-anchor">#</a> Flex 文件规则</h3> <p>flex 文件，即<code>.l</code>，分三个区域</p> <ul><li>定义区域</li> <li>规则区域</li> <li>c 代码区域</li></ul> <p>1️⃣ 定义区域：引入所需 c 头文件以及写好宏定义，同时可以用正则式定义词法规则，如</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>delim		[ \t \n]
ws		{delim}+
letter		[A-Za-z_]
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>在此处定义的规则可以在规则区域通过大括号直接引入</p> <p>2️⃣ 规则区域：定义具体要识别的词法规则以及处理方式</p> <ul><li>字符串，如<code>while</code>，则定义为<code>&quot;while&quot; { return WHILE; }</code></li> <li>如事先在定义区域定义过，则用大括号引入，如<code>{ws} { ; }</code>，处理方式为空则表明识别但跳过</li></ul> <p>这里的处理方式实际上定义的是 yylex() 的函数体，即当 yylex 识别到某一规则时，将如何处理并返回相应值</p> <p>3️⃣ C 代码区域：在这定义要用到的函数以及 main 函数，如题目要求要写文件，就可以定义一个 write 函数，根据 yylex() 的返回值，我这里自定义为 int 类型，向文件里写入相应内容</p> <p>当然也可以直接把写文件的语句写在每个词法规则的处理方式中，在 yylex 函数中解决</p> <h3 id="词法分析器规则编写"><a href="#词法分析器规则编写" class="header-anchor">#</a> 词法分析器规则编写</h3> <blockquote><p>less 语言</p></blockquote> <p>lex.l</p> <div class="language-less line-numbers-mode"><pre class="language-less"><code><span class="token comment">/*** 定義區塊***/</span>

<span class="token selector">%</span><span class="token punctuation">{</span>
<span class="token comment">/* 會直接照搬放檔頭的C code */</span>
#include &lt;stdio.h&gt;
#include &lt;string.h&gt;

#define NEWLINE 0
#define ID 1
#define NUMBER 2
#define STR 3
#define CHARACTER 4

<span class="token comment">// 关键字</span>
#define CONST 5
#define INT 6
#define CHAR 7
#define VOID 8
#define MAIN 9

#define IF 10
#define ELSE 11
#define	DO 12
#define WHILE 13
#define FOR 14
#define SCAN 15
#define PRINT 16
#define RETURN 17


<span class="token comment">// 赋值、算术运算</span>
#define AS 18
#define ADD 19
#define DEC 20
#define MUL 21
#define DIV 22

<span class="token comment">// 比较</span>
#define LT 23
#define	LE 24
#define GT 25
#define	GE 26
#define	EQ 27
#define NEQ 28

<span class="token comment">// 分号、逗号</span>
#define SEM 29
#define COM 30

<span class="token comment">// 括号</span>
#define LPT 31
#define RPT 32
#define LBK 33
#define RBK 34
#define LBE 35
#define RBE 36




%<span class="token punctuation">}</span>

<span class="token selector">delim		[ \t \n]
ws</span>		<span class="token punctuation">{</span>delim<span class="token punctuation">}</span><span class="token selector">+
letter		[A-Za-z_]
digit		[0-9]
id</span>		<span class="token punctuation">{</span>letter<span class="token punctuation">}</span><span class="token selector">(</span><span class="token punctuation">{</span>letter<span class="token punctuation">}</span><span class="token selector">|</span><span class="token punctuation">{</span>digit<span class="token punctuation">}</span><span class="token selector">)*
number</span>		<span class="token punctuation">{</span>digit<span class="token punctuation">}</span><span class="token operator">+</span><span class="token selector">(\.</span><span class="token punctuation">{</span>digit<span class="token punctuation">}</span><span class="token operator">+</span><span class="token punctuation">)</span>?<span class="token selector">(E[+-]?</span><span class="token punctuation">{</span>digit<span class="token punctuation">}</span><span class="token operator">+</span><span class="token punctuation">)</span>?

<span class="token comment">/* 這裡告訴flex只要讀取輸入的檔案（不需要其他檔案）*/</span>

%%
    <span class="token comment">/*** 規則區塊***/</span>
    <span class="token comment">/* yytext是一個字串變數，內容是符合規則的字串本身。*/</span>

<span class="token selector">\&quot;[^\&quot;]*\&quot;</span>	<span class="token punctuation">{</span> return <span class="token punctuation">(</span>STR<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span> <span class="token comment">// 识别字符串，这里要手动去掉双引号</span>
<span class="token selector">'[^']'</span>		<span class="token punctuation">{</span> return <span class="token punctuation">(</span>CHARACTER<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span> <span class="token comment">// 识别字符，手动去掉单引号</span>

    <span class="token comment">/* 识别关键字及特殊符号 */</span>

<span class="token selector">&quot;const&quot;</span>		<span class="token punctuation">{</span> return <span class="token punctuation">(</span>CONST<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token selector">&quot;int&quot;</span>		<span class="token punctuation">{</span> return <span class="token punctuation">(</span>INT<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token selector">&quot;char&quot;</span>		<span class="token punctuation">{</span> return <span class="token punctuation">(</span>CHAR<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token selector">&quot;void&quot;</span>		<span class="token punctuation">{</span> return <span class="token punctuation">(</span>VOID<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token selector">&quot;main&quot;</span>		<span class="token punctuation">{</span> return <span class="token punctuation">(</span>MAIN<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token selector">&quot;if&quot;</span>		<span class="token punctuation">{</span> return <span class="token punctuation">(</span>IF<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token selector">&quot;else&quot;</span>		<span class="token punctuation">{</span> return <span class="token punctuation">(</span>ELSE<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token selector">&quot;do&quot;</span>		<span class="token punctuation">{</span> return <span class="token punctuation">(</span>DO<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token selector">&quot;while&quot;</span>		<span class="token punctuation">{</span> return <span class="token punctuation">(</span>WHILE<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token selector">&quot;for&quot;</span>		<span class="token punctuation">{</span> return <span class="token punctuation">(</span>FOR<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token selector">&quot;scanf&quot;</span>		<span class="token punctuation">{</span> return <span class="token punctuation">(</span>SCAN<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token selector">&quot;printf&quot;</span>	<span class="token punctuation">{</span> return <span class="token punctuation">(</span>PRINT<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token selector">&quot;return&quot;</span>	<span class="token punctuation">{</span> return <span class="token punctuation">(</span>RETURN<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>

<span class="token punctuation">{</span>id<span class="token punctuation">}</span>		<span class="token punctuation">{</span> return <span class="token punctuation">(</span>ID<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span> <span class="token comment">// 识别标识符</span>
<span class="token punctuation">{</span>number<span class="token punctuation">}</span>   	<span class="token punctuation">{</span> return <span class="token punctuation">(</span>NUMBER<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span> <span class="token comment">// 识别整数数字</span>

<span class="token punctuation">{</span>ws<span class="token punctuation">}</span>	 	<span class="token punctuation">{</span> <span class="token punctuation">;</span> <span class="token punctuation">}</span>

<span class="token selector">&quot;=&quot;</span>		<span class="token punctuation">{</span> return <span class="token punctuation">(</span>AS<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token selector">&quot;+&quot;</span>		<span class="token punctuation">{</span> return <span class="token punctuation">(</span>ADD<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token selector">&quot;-&quot;</span>		<span class="token punctuation">{</span> return <span class="token punctuation">(</span>DEC<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token selector">&quot;*&quot;</span>		<span class="token punctuation">{</span> return <span class="token punctuation">(</span>MUL<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token selector">&quot;/&quot;</span>		<span class="token punctuation">{</span> return <span class="token punctuation">(</span>DIV<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>

<span class="token selector">&quot;&lt;&quot;</span>		<span class="token punctuation">{</span> return <span class="token punctuation">(</span>LT<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token selector">&quot;&lt;=&quot;</span>		<span class="token punctuation">{</span> return <span class="token punctuation">(</span>LE<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token selector">&quot;&gt;&quot;</span>		<span class="token punctuation">{</span> return <span class="token punctuation">(</span>GT<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token selector">&quot;&gt;=&quot;</span>		<span class="token punctuation">{</span> return <span class="token punctuation">(</span>GE<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token selector">&quot;==&quot;</span>		<span class="token punctuation">{</span> return <span class="token punctuation">(</span>EQ<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token selector">&quot;!=&quot;</span>		<span class="token punctuation">{</span> return <span class="token punctuation">(</span>NEQ<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>

<span class="token string">&quot;;&quot;</span>		<span class="token punctuation">{</span> return <span class="token punctuation">(</span>SEM<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token selector">&quot;,&quot;</span>		<span class="token punctuation">{</span> return <span class="token punctuation">(</span>COM<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>

<span class="token string">&quot;(&quot;</span>		<span class="token punctuation">{</span> return <span class="token punctuation">(</span>LPT<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token string">&quot;)&quot;</span>		<span class="token punctuation">{</span> return <span class="token punctuation">(</span>RPT<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token selector">&quot;[&quot;</span>		<span class="token punctuation">{</span> return <span class="token punctuation">(</span>LBK<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token selector">&quot;]&quot;</span>		<span class="token punctuation">{</span> return <span class="token punctuation">(</span>RBK<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token selector">&quot;</span><span class="token punctuation">{</span><span class="token selector">&quot;</span>		<span class="token punctuation">{</span> return <span class="token punctuation">(</span>LBE<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token string">&quot;}&quot;</span>		<span class="token punctuation">{</span> return <span class="token punctuation">(</span>RBE<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token selector">.</span>       	<span class="token punctuation">{</span> <span class="token punctuation">;</span> <span class="token punctuation">}</span>

%%
<span class="token comment">/*** C程式碼區塊***/</span>

<span class="token selector">int yywrap ()</span><span class="token punctuation">{</span>
  return 1<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector">void writeout(int c)</span><span class="token punctuation">{</span>
  <span class="token selector">switch(c)</span><span class="token punctuation">{</span>
	case <span class="token property">NEWLINE</span><span class="token punctuation">:</span> <span class="token function">fprintf</span><span class="token punctuation">(</span>yyout<span class="token punctuation">,</span> <span class="token string">&quot;\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>break<span class="token punctuation">;</span>

	case <span class="token property">ID</span><span class="token punctuation">:</span> <span class="token function">fprintf</span><span class="token punctuation">(</span>yyout<span class="token punctuation">,</span> <span class="token string">&quot;IDENFR %s&quot;</span><span class="token punctuation">,</span> yytext<span class="token punctuation">)</span><span class="token punctuation">;</span>break<span class="token punctuation">;</span>
	case <span class="token property">NUMBER</span><span class="token punctuation">:</span> <span class="token function">fprintf</span><span class="token punctuation">(</span>yyout<span class="token punctuation">,</span> <span class="token string">&quot;INTCON %s&quot;</span><span class="token punctuation">,</span> yytext<span class="token punctuation">)</span><span class="token punctuation">;</span>break<span class="token punctuation">;</span>
	<span class="token selector">case STR:</span> <span class="token punctuation">{</span>
	    int n = <span class="token function">strlen</span><span class="token punctuation">(</span>yytext<span class="token punctuation">)</span><span class="token punctuation">;</span>
	    <span class="token comment">//printf(&quot;%d\n&quot;, n);</span>
	    <span class="token selector">for(int i = 0; i &lt; n-1; i++)</span><span class="token punctuation">{</span>
		yytext[i] = yytext[i<span class="token operator">+</span>1]<span class="token punctuation">;</span>
	    <span class="token punctuation">}</span>
	    yytext[n<span class="token operator">-</span>2] = <span class="token string">'\0'</span><span class="token punctuation">;</span>
	    <span class="token function">fprintf</span><span class="token punctuation">(</span>yyout<span class="token punctuation">,</span> <span class="token string">&quot;STRCON %s&quot;</span><span class="token punctuation">,</span> yytext<span class="token punctuation">)</span><span class="token punctuation">;</span>
	    break<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token selector">case CHARACTER:</span> <span class="token punctuation">{</span>
	    int n = <span class="token function">strlen</span><span class="token punctuation">(</span>yytext<span class="token punctuation">)</span><span class="token punctuation">;</span>
	    <span class="token comment">//printf(&quot;%d\n&quot;, n);</span>
	    <span class="token selector">for(int i = 0; i &lt; n-1; i++)</span><span class="token punctuation">{</span>
		yytext[i] = yytext[i<span class="token operator">+</span>1]<span class="token punctuation">;</span>
	    <span class="token punctuation">}</span>
	    yytext[n<span class="token operator">-</span>2] = <span class="token string">'\0'</span><span class="token punctuation">;</span>
	    <span class="token function">fprintf</span><span class="token punctuation">(</span>yyout<span class="token punctuation">,</span> <span class="token string">&quot;CHARCON %s&quot;</span><span class="token punctuation">,</span> yytext<span class="token punctuation">)</span><span class="token punctuation">;</span>
	    break<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token comment">// 关键字</span>
	case <span class="token property">CONST</span><span class="token punctuation">:</span> <span class="token function">fprintf</span><span class="token punctuation">(</span>yyout<span class="token punctuation">,</span> <span class="token string">&quot;CONSTTK %s&quot;</span><span class="token punctuation">,</span> yytext<span class="token punctuation">)</span><span class="token punctuation">;</span>break<span class="token punctuation">;</span>
	case <span class="token property">INT</span><span class="token punctuation">:</span> <span class="token function">fprintf</span><span class="token punctuation">(</span>yyout<span class="token punctuation">,</span> <span class="token string">&quot;INTTK %s&quot;</span><span class="token punctuation">,</span> yytext<span class="token punctuation">)</span><span class="token punctuation">;</span>break<span class="token punctuation">;</span>
	case <span class="token property">CHAR</span><span class="token punctuation">:</span> <span class="token function">fprintf</span><span class="token punctuation">(</span>yyout<span class="token punctuation">,</span> <span class="token string">&quot;CHARTK %s&quot;</span><span class="token punctuation">,</span> yytext<span class="token punctuation">)</span><span class="token punctuation">;</span>break<span class="token punctuation">;</span>
	case <span class="token property">VOID</span><span class="token punctuation">:</span> <span class="token function">fprintf</span><span class="token punctuation">(</span>yyout<span class="token punctuation">,</span> <span class="token string">&quot;VOIDTK %s&quot;</span><span class="token punctuation">,</span> yytext<span class="token punctuation">)</span><span class="token punctuation">;</span>break<span class="token punctuation">;</span>
	case <span class="token property">MAIN</span><span class="token punctuation">:</span> <span class="token function">fprintf</span><span class="token punctuation">(</span>yyout<span class="token punctuation">,</span> <span class="token string">&quot;MAINTK %s&quot;</span><span class="token punctuation">,</span> yytext<span class="token punctuation">)</span><span class="token punctuation">;</span>break<span class="token punctuation">;</span>

	case <span class="token property">IF</span><span class="token punctuation">:</span> <span class="token function">fprintf</span><span class="token punctuation">(</span>yyout<span class="token punctuation">,</span> <span class="token string">&quot;IFTK %s&quot;</span><span class="token punctuation">,</span> yytext<span class="token punctuation">)</span><span class="token punctuation">;</span>break<span class="token punctuation">;</span>
	case <span class="token property">ELSE</span><span class="token punctuation">:</span> <span class="token function">fprintf</span><span class="token punctuation">(</span>yyout<span class="token punctuation">,</span> <span class="token string">&quot;ELSETK %s&quot;</span><span class="token punctuation">,</span> yytext<span class="token punctuation">)</span><span class="token punctuation">;</span>break<span class="token punctuation">;</span>
	case <span class="token property">DO</span><span class="token punctuation">:</span> <span class="token function">fprintf</span><span class="token punctuation">(</span>yyout<span class="token punctuation">,</span> <span class="token string">&quot;DOTK %s&quot;</span><span class="token punctuation">,</span> yytext<span class="token punctuation">)</span><span class="token punctuation">;</span>break<span class="token punctuation">;</span>
	case <span class="token property">WHILE</span><span class="token punctuation">:</span> <span class="token function">fprintf</span><span class="token punctuation">(</span>yyout<span class="token punctuation">,</span> <span class="token string">&quot;WHILETK %s&quot;</span><span class="token punctuation">,</span> yytext<span class="token punctuation">)</span><span class="token punctuation">;</span>break<span class="token punctuation">;</span>
	case <span class="token property">FOR</span><span class="token punctuation">:</span> <span class="token function">fprintf</span><span class="token punctuation">(</span>yyout<span class="token punctuation">,</span> <span class="token string">&quot;FORTK %s&quot;</span><span class="token punctuation">,</span> yytext<span class="token punctuation">)</span><span class="token punctuation">;</span>break<span class="token punctuation">;</span>
	case <span class="token property">SCAN</span><span class="token punctuation">:</span> <span class="token function">fprintf</span><span class="token punctuation">(</span>yyout<span class="token punctuation">,</span> <span class="token string">&quot;SCANFTK %s&quot;</span><span class="token punctuation">,</span> yytext<span class="token punctuation">)</span><span class="token punctuation">;</span>break<span class="token punctuation">;</span>
	case <span class="token property">PRINT</span><span class="token punctuation">:</span> <span class="token function">fprintf</span><span class="token punctuation">(</span>yyout<span class="token punctuation">,</span> <span class="token string">&quot;PRINTFTK %s&quot;</span><span class="token punctuation">,</span> yytext<span class="token punctuation">)</span><span class="token punctuation">;</span>break<span class="token punctuation">;</span>
	case <span class="token property">RETURN</span><span class="token punctuation">:</span> <span class="token function">fprintf</span><span class="token punctuation">(</span>yyout<span class="token punctuation">,</span> <span class="token string">&quot;RETURNTK %s&quot;</span><span class="token punctuation">,</span> yytext<span class="token punctuation">)</span><span class="token punctuation">;</span>break<span class="token punctuation">;</span>


	<span class="token comment">// 赋值、算术运算</span>
	case <span class="token property">AS</span><span class="token punctuation">:</span> <span class="token function">fprintf</span><span class="token punctuation">(</span>yyout<span class="token punctuation">,</span> <span class="token string">&quot;ASSIGN %s&quot;</span><span class="token punctuation">,</span> yytext<span class="token punctuation">)</span><span class="token punctuation">;</span>break<span class="token punctuation">;</span>
	case <span class="token property">ADD</span><span class="token punctuation">:</span> <span class="token function">fprintf</span><span class="token punctuation">(</span>yyout<span class="token punctuation">,</span> <span class="token string">&quot;PLUS %s&quot;</span><span class="token punctuation">,</span> yytext<span class="token punctuation">)</span><span class="token punctuation">;</span>break<span class="token punctuation">;</span>
	case <span class="token property">DEC</span><span class="token punctuation">:</span> <span class="token function">fprintf</span><span class="token punctuation">(</span>yyout<span class="token punctuation">,</span> <span class="token string">&quot;MINU %s&quot;</span><span class="token punctuation">,</span> yytext<span class="token punctuation">)</span><span class="token punctuation">;</span>break<span class="token punctuation">;</span>
	case <span class="token property">MUL</span><span class="token punctuation">:</span> <span class="token function">fprintf</span><span class="token punctuation">(</span>yyout<span class="token punctuation">,</span> <span class="token string">&quot;MULT %s&quot;</span><span class="token punctuation">,</span> yytext<span class="token punctuation">)</span><span class="token punctuation">;</span>break<span class="token punctuation">;</span>
	case <span class="token property">DIV</span><span class="token punctuation">:</span> <span class="token function">fprintf</span><span class="token punctuation">(</span>yyout<span class="token punctuation">,</span> <span class="token string">&quot;DIV %s&quot;</span><span class="token punctuation">,</span> yytext<span class="token punctuation">)</span><span class="token punctuation">;</span>break<span class="token punctuation">;</span>
	
	<span class="token comment">// 比较</span>
	case <span class="token property">LT</span><span class="token punctuation">:</span> <span class="token function">fprintf</span><span class="token punctuation">(</span>yyout<span class="token punctuation">,</span> <span class="token string">&quot;LSS %s&quot;</span><span class="token punctuation">,</span> yytext<span class="token punctuation">)</span><span class="token punctuation">;</span>break<span class="token punctuation">;</span>
	case <span class="token property">LE</span><span class="token punctuation">:</span> <span class="token function">fprintf</span><span class="token punctuation">(</span>yyout<span class="token punctuation">,</span> <span class="token string">&quot;LEQ %s&quot;</span><span class="token punctuation">,</span> yytext<span class="token punctuation">)</span><span class="token punctuation">;</span>break<span class="token punctuation">;</span>
	case <span class="token property">GT</span><span class="token punctuation">:</span> <span class="token function">fprintf</span><span class="token punctuation">(</span>yyout<span class="token punctuation">,</span> <span class="token string">&quot;GRE %s&quot;</span><span class="token punctuation">,</span> yytext<span class="token punctuation">)</span><span class="token punctuation">;</span>break<span class="token punctuation">;</span>
	case <span class="token property">GE</span><span class="token punctuation">:</span> <span class="token function">fprintf</span><span class="token punctuation">(</span>yyout<span class="token punctuation">,</span> <span class="token string">&quot;GEQ %s&quot;</span><span class="token punctuation">,</span> yytext<span class="token punctuation">)</span><span class="token punctuation">;</span>break<span class="token punctuation">;</span>
	case <span class="token property">EQ</span><span class="token punctuation">:</span> <span class="token function">fprintf</span><span class="token punctuation">(</span>yyout<span class="token punctuation">,</span> <span class="token string">&quot;EQL %s&quot;</span><span class="token punctuation">,</span> yytext<span class="token punctuation">)</span><span class="token punctuation">;</span>break<span class="token punctuation">;</span>
	case <span class="token property">NEQ</span><span class="token punctuation">:</span> <span class="token function">fprintf</span><span class="token punctuation">(</span>yyout<span class="token punctuation">,</span> <span class="token string">&quot;NEQ %s&quot;</span><span class="token punctuation">,</span> yytext<span class="token punctuation">)</span><span class="token punctuation">;</span>break<span class="token punctuation">;</span>
	
	<span class="token comment">// 分号、逗号</span>
	case <span class="token property">SEM</span><span class="token punctuation">:</span> <span class="token function">fprintf</span><span class="token punctuation">(</span>yyout<span class="token punctuation">,</span> <span class="token string">&quot;SEMICN %s&quot;</span><span class="token punctuation">,</span> yytext<span class="token punctuation">)</span><span class="token punctuation">;</span>break<span class="token punctuation">;</span>
	case <span class="token property">COM</span><span class="token punctuation">:</span> <span class="token function">fprintf</span><span class="token punctuation">(</span>yyout<span class="token punctuation">,</span> <span class="token string">&quot;COMMA %s&quot;</span><span class="token punctuation">,</span> yytext<span class="token punctuation">)</span><span class="token punctuation">;</span>break<span class="token punctuation">;</span>
	
	<span class="token comment">// 括号</span>
	case <span class="token property">LPT</span><span class="token punctuation">:</span> <span class="token function">fprintf</span><span class="token punctuation">(</span>yyout<span class="token punctuation">,</span> <span class="token string">&quot;LPARENT %s&quot;</span><span class="token punctuation">,</span> yytext<span class="token punctuation">)</span><span class="token punctuation">;</span>break<span class="token punctuation">;</span>
	case <span class="token property">RPT</span><span class="token punctuation">:</span> <span class="token function">fprintf</span><span class="token punctuation">(</span>yyout<span class="token punctuation">,</span> <span class="token string">&quot;RPARENT %s&quot;</span><span class="token punctuation">,</span> yytext<span class="token punctuation">)</span><span class="token punctuation">;</span>break<span class="token punctuation">;</span>
	case <span class="token property">LBK</span><span class="token punctuation">:</span> <span class="token function">fprintf</span><span class="token punctuation">(</span>yyout<span class="token punctuation">,</span> <span class="token string">&quot;LBRACK %s&quot;</span><span class="token punctuation">,</span> yytext<span class="token punctuation">)</span><span class="token punctuation">;</span>break<span class="token punctuation">;</span>
	case <span class="token property">RBK</span><span class="token punctuation">:</span> <span class="token function">fprintf</span><span class="token punctuation">(</span>yyout<span class="token punctuation">,</span> <span class="token string">&quot;RBRACK %s&quot;</span><span class="token punctuation">,</span> yytext<span class="token punctuation">)</span><span class="token punctuation">;</span>break<span class="token punctuation">;</span>
	case <span class="token property">LBE</span><span class="token punctuation">:</span> <span class="token function">fprintf</span><span class="token punctuation">(</span>yyout<span class="token punctuation">,</span> <span class="token string">&quot;LBRACE %s&quot;</span><span class="token punctuation">,</span> yytext<span class="token punctuation">)</span><span class="token punctuation">;</span>break<span class="token punctuation">;</span>
	case <span class="token property">RBE</span><span class="token punctuation">:</span> <span class="token function">fprintf</span><span class="token punctuation">(</span>yyout<span class="token punctuation">,</span> <span class="token string">&quot;RBRACE %s&quot;</span><span class="token punctuation">,</span> yytext<span class="token punctuation">)</span><span class="token punctuation">;</span>break<span class="token punctuation">;</span>
    	<span class="token property">default</span><span class="token punctuation">:</span> break<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  return<span class="token punctuation">;</span>
<span class="token punctuation">}</span>


<span class="token selector">int main (void)</span><span class="token punctuation">{</span>
	int c<span class="token punctuation">;</span>
	<span class="token comment">/*
	if (argc &gt;= 2){
	    if ((yyin = fopen(argv[1], &quot;r&quot;)) == NULL){
		printf(&quot;Can't open file %s\n&quot;, argv[1]);
	   	return 1;
	    }
	    if (argc &gt;= 3){
		yyout = fopen(argv[2], &quot;w&quot;);
	    }
	}
	*/</span>
	<span class="token function">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span>yyin = <span class="token function">fopen</span><span class="token punctuation">(</span><span class="token string">&quot;testfile.txt&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;r&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> == NULL<span class="token selector">)</span><span class="token punctuation">{</span>
	    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;can't open testfile.txt&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	    return 1<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token function">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span>yyout = <span class="token function">fopen</span><span class="token punctuation">(</span><span class="token string">&quot;output.txt&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;w&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> == NULL<span class="token selector">)</span><span class="token punctuation">{</span>
	    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;can't open output.txt&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	    return 1<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token selector">while (c = yylex())</span><span class="token punctuation">{</span>
	    <span class="token function">writeout</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">;</span>
	    <span class="token function">writeout</span><span class="token punctuation">(</span>NEWLINE<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token function">fclose</span><span class="token punctuation">(</span>yyin<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">fclose</span><span class="token punctuation">(</span>yyout<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">/*
	if(argc&gt;=2){
	    fclose(yyin);
	    if (argc &gt;= 3) fclose(yyout);
	}
	*/</span>
	return 0<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br><span class="line-number">149</span><br><span class="line-number">150</span><br><span class="line-number">151</span><br><span class="line-number">152</span><br><span class="line-number">153</span><br><span class="line-number">154</span><br><span class="line-number">155</span><br><span class="line-number">156</span><br><span class="line-number">157</span><br><span class="line-number">158</span><br><span class="line-number">159</span><br><span class="line-number">160</span><br><span class="line-number">161</span><br><span class="line-number">162</span><br><span class="line-number">163</span><br><span class="line-number">164</span><br><span class="line-number">165</span><br><span class="line-number">166</span><br><span class="line-number">167</span><br><span class="line-number">168</span><br><span class="line-number">169</span><br><span class="line-number">170</span><br><span class="line-number">171</span><br><span class="line-number">172</span><br><span class="line-number">173</span><br><span class="line-number">174</span><br><span class="line-number">175</span><br><span class="line-number">176</span><br><span class="line-number">177</span><br><span class="line-number">178</span><br><span class="line-number">179</span><br><span class="line-number">180</span><br><span class="line-number">181</span><br><span class="line-number">182</span><br><span class="line-number">183</span><br><span class="line-number">184</span><br><span class="line-number">185</span><br><span class="line-number">186</span><br><span class="line-number">187</span><br><span class="line-number">188</span><br><span class="line-number">189</span><br><span class="line-number">190</span><br><span class="line-number">191</span><br><span class="line-number">192</span><br><span class="line-number">193</span><br><span class="line-number">194</span><br><span class="line-number">195</span><br><span class="line-number">196</span><br><span class="line-number">197</span><br><span class="line-number">198</span><br><span class="line-number">199</span><br><span class="line-number">200</span><br><span class="line-number">201</span><br><span class="line-number">202</span><br><span class="line-number">203</span><br><span class="line-number">204</span><br><span class="line-number">205</span><br><span class="line-number">206</span><br><span class="line-number">207</span><br><span class="line-number">208</span><br><span class="line-number">209</span><br><span class="line-number">210</span><br><span class="line-number">211</span><br><span class="line-number">212</span><br><span class="line-number">213</span><br><span class="line-number">214</span><br><span class="line-number">215</span><br><span class="line-number">216</span><br><span class="line-number">217</span><br><span class="line-number">218</span><br><span class="line-number">219</span><br><span class="line-number">220</span><br><span class="line-number">221</span><br><span class="line-number">222</span><br><span class="line-number">223</span><br><span class="line-number">224</span><br><span class="line-number">225</span><br><span class="line-number">226</span><br><span class="line-number">227</span><br><span class="line-number">228</span><br><span class="line-number">229</span><br><span class="line-number">230</span><br><span class="line-number">231</span><br><span class="line-number">232</span><br><span class="line-number">233</span><br><span class="line-number">234</span><br><span class="line-number">235</span><br><span class="line-number">236</span><br><span class="line-number">237</span><br><span class="line-number">238</span><br><span class="line-number">239</span><br><span class="line-number">240</span><br><span class="line-number">241</span><br></div></div><h3 id="编译运行"><a href="#编译运行" class="header-anchor">#</a> 编译运行</h3> <p>run.sh</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>flex lex.l
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>将会在当前目录下生成对应的 C 源码 lex.yy.c，用 gcc 编译</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code>gcc <span class="token parameter variable">-o</span> lexer lex.yy.c
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>得到可执行文件 lexer，直接运行即可</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code>./lexer
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>测试结果满昏</p> <h2 id="flex-bison-实现计算器"><a href="#flex-bison-实现计算器" class="header-anchor">#</a> Flex/Bison 实现计算器</h2> <p>使用 flex 和 bison 实现计算器</p> <p>bison 文件同样分为三部分</p> <ol><li>定义区域：定义 c 头文件，token 符号，将自动分配 int 值</li> <li>规则区域：定义文法</li> <li>c 代码区域：同 flex</li></ol> <h3 id="词法定义"><a href="#词法定义" class="header-anchor">#</a> 词法定义</h3> <p>calc.l：识别运算符和数字</p> <div class="language-c line-numbers-mode"><pre class="language-c"><code><span class="token operator">%</span><span class="token punctuation">{</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&quot;y.tab.h&quot;</span></span>
<span class="token operator">%</span><span class="token punctuation">}</span>

<span class="token operator">%</span><span class="token operator">%</span>
<span class="token punctuation">[</span><span class="token number">0</span><span class="token operator">-</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">+</span>          <span class="token punctuation">{</span> yylval <span class="token operator">=</span> <span class="token function">atoi</span><span class="token punctuation">(</span>yytext<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">return</span> NUMBER<span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">[</span><span class="token operator">-</span><span class="token operator">/</span><span class="token operator">+</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n<span class="token punctuation">]</span>      <span class="token punctuation">{</span> <span class="token keyword">return</span> yytext<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">.</span>               <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">/* end when meet everything else */</span> <span class="token punctuation">}</span>
<span class="token operator">%</span><span class="token operator">%</span>

<span class="token keyword">int</span> <span class="token function">yywrap</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> 
    <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><h3 id="文法定义"><a href="#文法定义" class="header-anchor">#</a> 文法定义</h3> <p>calc.y：处理识别到的 token，将注释去掉将可以读 / 写文件</p> <div class="language-c line-numbers-mode"><pre class="language-c"><code><span class="token operator">%</span><span class="token punctuation">{</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h&gt;</span></span>
<span class="token keyword">void</span> <span class="token function">yyerror</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> msg<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">static</span> FILE<span class="token operator">*</span> yyout<span class="token punctuation">;</span>
<span class="token operator">%</span><span class="token punctuation">}</span>

<span class="token operator">%</span>token NUMBER

<span class="token operator">%</span>left <span class="token char">'+'</span> <span class="token char">'-'</span>
<span class="token operator">%</span>left <span class="token char">'*'</span> <span class="token char">'/'</span>

<span class="token operator">%</span><span class="token operator">%</span>

S   <span class="token operator">:</span>   S E <span class="token char">'\n'</span>        <span class="token punctuation">{</span> <span class="token function">fprintf</span><span class="token punctuation">(</span>yyout<span class="token punctuation">,</span> <span class="token string">&quot;ans = %d\n&quot;</span><span class="token punctuation">,</span> $<span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token operator">|</span>   <span class="token comment">/* empty */</span>     <span class="token punctuation">{</span> <span class="token comment">/* empty */</span> <span class="token punctuation">}</span>
    <span class="token punctuation">;</span>

E   <span class="token operator">:</span>   E <span class="token char">'+'</span> E         <span class="token punctuation">{</span> $$ <span class="token operator">=</span> $<span class="token number">1</span> <span class="token operator">+</span> $<span class="token number">3</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token operator">|</span>   E <span class="token char">'-'</span> E         <span class="token punctuation">{</span> $$ <span class="token operator">=</span> $<span class="token number">1</span> <span class="token operator">-</span> $<span class="token number">3</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token operator">|</span>   E <span class="token char">'*'</span> E         <span class="token punctuation">{</span> $$ <span class="token operator">=</span> $<span class="token number">1</span> <span class="token operator">*</span> $<span class="token number">3</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token operator">|</span>   E <span class="token char">'/'</span> E         <span class="token punctuation">{</span> $$ <span class="token operator">=</span> $<span class="token number">1</span> <span class="token operator">/</span> $<span class="token number">3</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token operator">|</span>   NUMBER          <span class="token punctuation">{</span> $$ <span class="token operator">=</span> $<span class="token number">1</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token operator">|</span>   <span class="token char">'('</span> E <span class="token char">')'</span>       <span class="token punctuation">{</span> $$ <span class="token operator">=</span> $<span class="token number">2</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token punctuation">;</span>

<span class="token operator">%</span><span class="token operator">%</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">extern</span> FILE <span class="token operator">*</span>yyin<span class="token punctuation">;</span>
    <span class="token comment">//yyin = fopen(&quot;testfile.txt&quot;, &quot;r&quot;);</span>
    <span class="token keyword">extern</span> FILE <span class="token operator">*</span>yyout<span class="token punctuation">;</span>
    <span class="token comment">//yyout = fopen(&quot;output.txt&quot;, &quot;w&quot;);</span>
    <span class="token function">yyparse</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br></div></div><h3 id="联合编译"><a href="#联合编译" class="header-anchor">#</a> 联合编译</h3> <p>build.sh</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>flex calc.l
bison <span class="token parameter variable">-vtdy</span> calc.y
gcc <span class="token parameter variable">-o</span> calc lex.yy.c y.tab.c
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>执行</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>./calc

<span class="token number">1</span>+2
<span class="token assign-left variable">ans</span><span class="token operator">=</span><span class="token number">3</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>无敌了，谁还在手搓计算器</p> <h2 id="语法分析器-parser"><a href="#语法分析器-parser" class="header-anchor">#</a> 语法分析器 Parser</h2> <h3 id="文法定义-2"><a href="#文法定义-2" class="header-anchor">#</a> 文法定义</h3> <p>flex &amp; bison 语法分析器半成品，见 parser 文件夹，要求实现以下文法，一碰到函数就尼玛离谱，文法定义的有问题</p> <ul><li><code>＜加法运算符＞ ::= +｜-</code></li> <li><code>＜乘法运算符＞ ::= *｜/</code></li> <li><code>＜关系运算符＞ ::= &lt;｜&lt;=｜&gt;｜&gt;=｜!=｜==</code></li> <li><code>＜字母＞ ::= ＿｜a｜．．．｜z｜A｜．．．｜Z</code></li> <li><code>＜数字＞ ::= ０｜＜非零数字＞</code></li> <li><code>＜非零数字＞ ::= １｜．．．｜９</code></li> <li><code>＜字符＞ ::= '＜加法运算符＞'｜'＜乘法运算符＞'｜'＜字母＞'｜'＜数字＞'</code></li> <li><code>＜字符串＞ ::= &quot;｛十进制编码为32,33,35-126的ASCII字符｝&quot;</code></li> <li><code>＜程序＞ ::= ［＜常量说明＞］［＜变量说明＞］{＜有返回值函数定义＞|＜无返回值函数定义＞}＜主函数＞</code></li> <li><code>＜常量说明＞ ::= const＜常量定义＞;{ const＜常量定义＞;}</code></li> <li><code>＜常量定义＞ ::= int＜标识符＞＝＜整数＞{,＜标识符＞＝＜整数＞} | char＜标识符＞＝＜字符＞{,＜标识符＞＝＜字符＞}</code></li> <li><code>＜无符号整数＞ ::= ＜非零数字＞｛＜数字＞｝| 0</code></li> <li><code>＜整数＞ ::= ［＋｜－］＜无符号整数＞</code></li> <li><code>＜标识符＞ ::= ＜字母＞｛＜字母＞｜＜数字＞｝</code></li> <li><code>＜声明头部＞ ::= int＜标识符＞ |char＜标识符＞</code></li> <li><code>＜变量说明＞ ::= ＜变量定义＞;{＜变量定义＞;}</code></li> <li><code>＜变量定义＞ ::= ＜类型标识符＞(＜标识符＞|＜标识符＞'['＜无符号整数＞']'){,(＜标识符＞|＜标识符＞'['＜无符号整数＞']' )}</code></li> <li><code>＜类型标识符＞ ::= int | char</code></li> <li><code>＜有返回值函数定义＞ ::= ＜声明头部＞'('＜参数表＞')' '{'＜复合语句＞'}'</code></li> <li><code>＜无返回值函数定义＞ ::= void＜标识符＞'('＜参数表＞')''{'＜复合语句＞'}'</code></li> <li><code>＜复合语句＞ ::= ［＜常量说明＞］［＜变量说明＞］＜语句列＞</code></li> <li><code>＜参数表＞ ::= ＜类型标识符＞＜标识符＞{,＜类型标识符＞＜标识符＞}| ＜空＞</code></li> <li><code>＜主函数＞ ::= void main‘(’‘)’ ‘{’＜复合语句＞‘}’</code></li> <li><code>＜表达式＞ ::= ［＋｜－］＜项＞{＜加法运算符＞＜项＞}</code></li> <li><code>＜项＞ ::= ＜因子＞{＜乘法运算符＞＜因子＞}</code></li> <li><code>＜因子＞ ::= ＜标识符＞｜＜标识符＞'['＜表达式＞']'|'('＜表达式＞')'｜＜整数＞|＜字符＞｜＜有返回值函数调用语句＞</code></li> <li><code>＜语句＞ ::= ＜条件语句＞｜＜循环语句＞| '{'＜语句列＞'}'| ＜有返回值函数调用语句＞; |＜无返回值函数调用语句＞;｜＜赋值语句＞;｜＜读语句＞;｜＜写语句＞;｜＜空＞;|＜返回语句＞;</code></li> <li><code>＜赋值语句＞ ::= ＜标识符＞＝＜表达式＞|＜标识符＞'['＜表达式＞']'=＜表达式＞</code></li> <li><code>＜条件语句＞ ::= if '('＜条件＞')'＜语句＞［else＜语句＞］</code></li> <li><code>＜条件＞ ::= ＜表达式＞＜关系运算符＞＜表达式＞ //整型表达式之间才能进行关系运算 ｜＜表达式＞ //表达式为整型，其值为0条件为假，值不为0时条件为真</code></li> <li><code>＜循环语句＞ ::= while '('＜条件＞')'＜语句＞| do＜语句＞while '('＜条件＞')' |for'('＜标识符＞＝＜表达式＞;＜条件＞;＜标识符＞＝＜标识符＞(+|-)＜步长＞')'＜语句＞</code></li> <li><code>＜步长＞::= ＜无符号整数＞</code></li> <li><code>＜有返回值函数调用语句＞ ::= ＜标识符＞'('＜值参数表＞')'</code></li> <li><code>＜无返回值函数调用语句＞ ::= ＜标识符＞'('＜值参数表＞')'</code></li> <li><code>＜值参数表＞ ::= ＜表达式＞{,＜表达式＞}｜＜空＞</code></li> <li><code>＜语句列＞ ::= ｛＜语句＞｝</code></li> <li><code>＜读语句＞ ::= scanf '('＜标识符＞{,＜标识符＞}')'</code></li> <li><code>＜写语句＞ ::= printf '(' ＜字符串＞,＜表达式＞ ')'| printf '('＜字符串＞ ')'| printf '('＜表达式＞')'</code></li> <li><code>＜返回语句＞ ::= return['('＜表达式＞')']</code></li></ul> <h3 id="语法分析器"><a href="#语法分析器" class="header-anchor">#</a> 语法分析器</h3> <p>需要对第一部分的词法分析器做改动，然后自定义语法规则联合编译，详见 parser 文件夹，太失败了</p> <p>parser.y</p> <div class="language-yacas line-numbers-mode"><pre class="language-text"><code>%{
#include &lt;stdio.h&gt;
extern FILE* yyout;
void yyerror(const char* msg) {}
int yylex();
%}

%debug

%locations

%token STR // 字符串
%token CHARACTER // 字符

%token CONST // const
%token INT // int
%token CHAR // char
%token VOID // void
%token MAIN // main
%token IF // if
%token ELSE // else
%token DO // do
%token WHILE // while
%token FOR // for
%token SCAN // scanf
%token PRINT // printf
%token RETURN // return

%token ID // 识别标识符
%token NUMBER // 整数
%token ZERO // 0

%token LPARENT // (
%token RPARENT // )
%token LBRACE RBRACE RBRACK LBRACK // {}, [] 
%token SEMICOLON // ;
%token COMMA // ,

%left ASSIGN // 赋值 =
%left NEQ EQL // 等，不等 == !=
%left LSS GRE LEQ GEQ // 比较 &lt; &gt; &lt;= &gt;=
%left ADD SUB // 加减 + -
%left MUL DIV // 乘除 * /

%start s
%%

/* 语法规则 */
s
    : s program				{ fprintf(yyout, &quot;&lt;程序&gt;\n&quot;); }
    | program				
    ;

add_cal
    : ADD
    | SUB
    ;

mul_cal
    : MUL
    | DIV
    ;

relation_cal
    : NEQ
    | EQL
    | LSS
    | GRE
    | LEQ
    | GEQ
    ;

character
    : CHARACTER
    ;

type
    : INT
    | CHAR
    ;

string
    : STR				{ fprintf(yyout, &quot;&lt;字符串&gt;\n&quot;); }
    ;


program
    : declaration
    | function
    ;

declaration
    : const_declaration			{ fprintf(yyout, &quot;&lt;常量说明&gt;\n&quot;); }
    | variable_declaration		{ fprintf(yyout, &quot;&lt;变量说明&gt;\n&quot;); }
    ;

const_declaration
    : const_declaration const_definition SEMICOLON 
    | const_definition SEMICOLON
    ;

const_definition
    : const_definition SEMICOLON CONST type const_assign  
    | CONST type const_assign  		  
    ;

const_assign
    : const_assign COMMA ID ASSIGN signed_number { fprintf(yyout, &quot;&lt;常量定义&gt;\n&quot;); }
    | ID ASSIGN signed_number			 { fprintf(yyout, &quot;&lt;常量定义&gt;\n&quot;); }
    | const_assign COMMA ID ASSIGN character	 { fprintf(yyout, &quot;&lt;常量定义&gt;\n&quot;); }
    | ID ASSIGN character			 { fprintf(yyout, &quot;&lt;常量定义&gt;\n&quot;); }		
    ;


unsigned_number
    : num_without_sign		{ fprintf(yyout, &quot;&lt;无符号整数&gt;\n&quot;); }
    ;

signed_number
    : num_with_sign		{ fprintf(yyout, &quot;&lt;整数&gt;\n&quot;); }
    ;

num_with_sign
    : unsigned_number
    | ADD unsigned_number
    | SUB unsigned_number
    ;

num_without_sign
    : NUMBER
    | ZERO
    ;

variable_declaration
    : variable_declaration variable_definition SEMICOLON 
    | variable_definition SEMICOLON 			 
    ;

variable_definition 
    : type variable_assign     
    ;

variable_assign
    : variable_assign COMMA variable
    | variable
    ;

variable
    : ID				{ fprintf(yyout, &quot;&lt;变量定义&gt;\n&quot;); }
    | ID LBRACK unsigned_number RBRACK  { fprintf(yyout, &quot;&lt;变量定义&gt;\n&quot;); }
    ;



function
    : void 	{ fprintf(yyout, &quot;&lt;无返回值函数定义&gt;\n&quot;); }
    | general   { fprintf(yyout, &quot;&lt;有返回值函数定义&gt;\n&quot;); }
    | main      { fprintf(yyout, &quot;&lt;主函数&gt;\n&quot;); }
    ;

void
    : VOID ID LPARENT param_list RPARENT LBRACE complex_sentence RBRACE 
    ;

general
    : declaration_head LPARENT param_list RPARENT LBRACE complex_sentence RBRACE 
    ;

main
    : VOID MAIN LPARENT RPARENT LBRACE complex_sentence RBRACE 
    ;

declaration_head
    : type ID			{ fprintf(yyout, &quot;&lt;声明头部&gt;\n&quot;); }
    ;

param_list
    : type param	    	{ fprintf(yyout, &quot;&lt;参数表&gt;\n&quot;); }
    |
    ;	

param
    : ID
    | param COMMA type ID
    ;

complex_sentence
    : const_declaration variable_declaration sentence_list    { fprintf(yyout, &quot;&lt;复合语句&gt;\n&quot;); }
    ;

expression
    : expression add_cal item	{ fprintf(yyout, &quot;&lt;表达式&gt;\n&quot;); }
    | expr			
    ;

expr
    : add_cal item
    | item			{ fprintf(yyout, &quot;&lt;项&gt;\n&quot;); }
    ;

item
    : item mul_cal fact
    | fact			{ fprintf(yyout, &quot;&lt;因子&gt;\n&quot;); }
    ;

fact
    : ID				{ /*fprintf(yyout, &quot;&lt;标识符&gt;&quot;);*/ }
    | ID LBRACK expression RBRACK
    | LPARENT expression RPARENT
    | signed_number
    | character				{ /*fprintf(yyout, &quot;&lt;字符&gt;&quot;);*/ }
    | call_with_return			{ fprintf(yyout, &quot;&lt;有返回值函数调用语句&gt;\n&quot;); }
    ;

sentence
    : condition_sentence SEMICOLON		{ fprintf(yyout, &quot;&lt;条件语句&gt;\n&quot;); }
    | circle_sentence SEMICOLON			{ fprintf(yyout, &quot;&lt;循环语句&gt;\n&quot;); }
    | LBRACE sentence_list RBRACE SEMICOLON	{ fprintf(yyout, &quot;&lt;语句列&gt;\n&quot;); }
    | call_with_return SEMICOLON		{ fprintf(yyout, &quot;&lt;有返回值函数调用语句&gt;\n&quot;); }
    | call_without_return SEMICOLON		{ fprintf(yyout, &quot;&lt;无返回值函数调用语句&gt;\n&quot;); }
    | assign_sentence SEMICOLON			{ fprintf(yyout, &quot;&lt;赋值语句&gt;\n&quot;); }
    | read_sentence SEMICOLON			{ fprintf(yyout, &quot;&lt;读语句&gt;\n&quot;); }
    | write_sentence SEMICOLON			{ fprintf(yyout, &quot;&lt;写语句&gt;\n&quot;); }
    | SEMICOLON
    | return_sentence SEMICOLON			{ fprintf(yyout, &quot;&lt;返回语句&gt;\n&quot;); }
    ;

assign_sentence
    : ID ASSIGN expression
    | ID LBRACK expression RBRACK ASSIGN expression
    ;

condition_sentence
    : IF LPARENT condition RPARENT sentence		  
    | IF LPARENT condition RPARENT sentence ELSE sentence
    ;

condition
    : expression relation_cal expression { fprintf(yyout, &quot;&lt;条件&gt;\n&quot;); }
    | expression			 { fprintf(yyout, &quot;&lt;条件&gt;\n&quot;); }
    ;

circle_sentence
    : WHILE LPARENT condition RPARENT sentence
    | DO sentence WHILE LPARENT condition RPARENT
    | FOR LPARENT ID ASSIGN expression SEMICOLON condition SEMICOLON ID ASSIGN ID add_cal step RPARENT sentence
    ;

step
    : unsigned_number		{ fprintf(yyout, &quot;&lt;步长&gt;\n&quot;); }
    ;

call_with_return
    : ID LPARENT value_param_list RPARENT
    ;

call_without_return
    : ID LPARENT value_param_list RPARENT
    ;

value_param_list
    : table 		{ fprintf(yyout, &quot;&lt;值参数表&gt;\n&quot;); }
    |
    ;

table
    : expression
    | table COMMA expression
    ;

sentence_list
    : sentence_list sentence
    |
    ;

read_sentence
    : SCAN LPARENT id_list RPARENT
    ;

id_list
    : ID
    | id_list COMMA ID
    ;

write_sentence
    : PRINT LPARENT string COMMA expression RPARENT
    | PRINT LPARENT string RPARENT
    | PRINT LPARENT expression RPARENT
    ;

return_sentence
    : RETURN SEMICOLON
    | RETURN LPARENT expression RPARENT
    ;

%%

int main() {
    extern FILE *yyin;
    //yyin = fopen(&quot;testfile.txt&quot;, &quot;r&quot;);
    extern FILE *yyout;
    //yyout = fopen(&quot;output.txt&quot;, &quot;w&quot;);
    while(yyparse()){}
    return 0;
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br><span class="line-number">149</span><br><span class="line-number">150</span><br><span class="line-number">151</span><br><span class="line-number">152</span><br><span class="line-number">153</span><br><span class="line-number">154</span><br><span class="line-number">155</span><br><span class="line-number">156</span><br><span class="line-number">157</span><br><span class="line-number">158</span><br><span class="line-number">159</span><br><span class="line-number">160</span><br><span class="line-number">161</span><br><span class="line-number">162</span><br><span class="line-number">163</span><br><span class="line-number">164</span><br><span class="line-number">165</span><br><span class="line-number">166</span><br><span class="line-number">167</span><br><span class="line-number">168</span><br><span class="line-number">169</span><br><span class="line-number">170</span><br><span class="line-number">171</span><br><span class="line-number">172</span><br><span class="line-number">173</span><br><span class="line-number">174</span><br><span class="line-number">175</span><br><span class="line-number">176</span><br><span class="line-number">177</span><br><span class="line-number">178</span><br><span class="line-number">179</span><br><span class="line-number">180</span><br><span class="line-number">181</span><br><span class="line-number">182</span><br><span class="line-number">183</span><br><span class="line-number">184</span><br><span class="line-number">185</span><br><span class="line-number">186</span><br><span class="line-number">187</span><br><span class="line-number">188</span><br><span class="line-number">189</span><br><span class="line-number">190</span><br><span class="line-number">191</span><br><span class="line-number">192</span><br><span class="line-number">193</span><br><span class="line-number">194</span><br><span class="line-number">195</span><br><span class="line-number">196</span><br><span class="line-number">197</span><br><span class="line-number">198</span><br><span class="line-number">199</span><br><span class="line-number">200</span><br><span class="line-number">201</span><br><span class="line-number">202</span><br><span class="line-number">203</span><br><span class="line-number">204</span><br><span class="line-number">205</span><br><span class="line-number">206</span><br><span class="line-number">207</span><br><span class="line-number">208</span><br><span class="line-number">209</span><br><span class="line-number">210</span><br><span class="line-number">211</span><br><span class="line-number">212</span><br><span class="line-number">213</span><br><span class="line-number">214</span><br><span class="line-number">215</span><br><span class="line-number">216</span><br><span class="line-number">217</span><br><span class="line-number">218</span><br><span class="line-number">219</span><br><span class="line-number">220</span><br><span class="line-number">221</span><br><span class="line-number">222</span><br><span class="line-number">223</span><br><span class="line-number">224</span><br><span class="line-number">225</span><br><span class="line-number">226</span><br><span class="line-number">227</span><br><span class="line-number">228</span><br><span class="line-number">229</span><br><span class="line-number">230</span><br><span class="line-number">231</span><br><span class="line-number">232</span><br><span class="line-number">233</span><br><span class="line-number">234</span><br><span class="line-number">235</span><br><span class="line-number">236</span><br><span class="line-number">237</span><br><span class="line-number">238</span><br><span class="line-number">239</span><br><span class="line-number">240</span><br><span class="line-number">241</span><br><span class="line-number">242</span><br><span class="line-number">243</span><br><span class="line-number">244</span><br><span class="line-number">245</span><br><span class="line-number">246</span><br><span class="line-number">247</span><br><span class="line-number">248</span><br><span class="line-number">249</span><br><span class="line-number">250</span><br><span class="line-number">251</span><br><span class="line-number">252</span><br><span class="line-number">253</span><br><span class="line-number">254</span><br><span class="line-number">255</span><br><span class="line-number">256</span><br><span class="line-number">257</span><br><span class="line-number">258</span><br><span class="line-number">259</span><br><span class="line-number">260</span><br><span class="line-number">261</span><br><span class="line-number">262</span><br><span class="line-number">263</span><br><span class="line-number">264</span><br><span class="line-number">265</span><br><span class="line-number">266</span><br><span class="line-number">267</span><br><span class="line-number">268</span><br><span class="line-number">269</span><br><span class="line-number">270</span><br><span class="line-number">271</span><br><span class="line-number">272</span><br><span class="line-number">273</span><br><span class="line-number">274</span><br><span class="line-number">275</span><br><span class="line-number">276</span><br><span class="line-number">277</span><br><span class="line-number">278</span><br><span class="line-number">279</span><br><span class="line-number">280</span><br><span class="line-number">281</span><br><span class="line-number">282</span><br><span class="line-number">283</span><br><span class="line-number">284</span><br><span class="line-number">285</span><br><span class="line-number">286</span><br><span class="line-number">287</span><br><span class="line-number">288</span><br><span class="line-number">289</span><br><span class="line-number">290</span><br><span class="line-number">291</span><br><span class="line-number">292</span><br><span class="line-number">293</span><br><span class="line-number">294</span><br><span class="line-number">295</span><br><span class="line-number">296</span><br><span class="line-number">297</span><br><span class="line-number">298</span><br><span class="line-number">299</span><br><span class="line-number">300</span><br><span class="line-number">301</span><br><span class="line-number">302</span><br><span class="line-number">303</span><br><span class="line-number">304</span><br><span class="line-number">305</span><br></div></div><p>联合词法分析器编译构建</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>flex lex.l
bison <span class="token parameter variable">-vtdy</span> parser.y 
gcc <span class="token parameter variable">-o</span> parser lex.yy.c y.tab.c
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>测试样例一个没过，太失败了，问题出在文法定义区域</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>parser.y: 警告: <span class="token number">9</span> 项偏移/归约冲突 <span class="token punctuation">[</span>-Wconflicts-sr<span class="token punctuation">]</span>
parser.y: 警告: <span class="token number">1</span> 项归约/归约冲突 <span class="token punctuation">[</span>-Wconflicts-rr<span class="token punctuation">]</span>
parser.y: note: rerun with option <span class="token string">'-Wcounterexamples'</span> to generate conflict counterexamples
parser.y:258.7-41: 警告: 由于冲突，解析器中的规则不起作用 <span class="token punctuation">[</span>-Wother<span class="token punctuation">]</span>
  <span class="token number">258</span> <span class="token operator">|</span>     <span class="token builtin class-name">:</span> ID LPARENT value_param_list RPARENT
      <span class="token operator">|</span>       ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h3 id="暴力破解"><a href="#暴力破解" class="header-anchor">#</a> 暴力破解</h3> <p>没有办法，为了通过测试完成任务，我把标准答案复制爬下来硬输出，样例过了 80 分，判题规则是这样的</p> <ul><li><p>他给定一个输入文件<code>testfile.txt</code>，我编写程序将其读入，其内容是完整的一串代码（在他的词法语法规则下的代码）</p></li> <li><p>我的任务是，将代码中每一个词及其所属的类型按行输出到文件<code>output.txt</code>，例如</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>INTTK int
IDENFR gets1
&lt;声明头部&gt;
LPARENT (
INTTK int
IDENFR var1
COMMA ,
INTTK int
IDENFR var2
&lt;参数表&gt;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div></li></ul> <p>好，但是他出现了一个致命问题，简单来说，就是，嗯，他每次给的样例输入是一样的，并且最致命的，他在比对的时候，居然把标准答案在网页上还给我了，我直接一个复制粘贴，然后用程序把粘下来的答案清洗一下（因为要按编码的格式例如<code>\n</code>进行换行）</p> <p>清洗函数，CleanData.java</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token operator">*</span></span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CleanData</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
        <span class="token class-name">String</span> outPath <span class="token operator">=</span> <span class="token string">&quot;/home/northboat/Desktop/data/output1.txt&quot;</span><span class="token punctuation">;</span>
        <span class="token class-name">File</span> out <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span>outPath<span class="token punctuation">)</span><span class="token punctuation">;</span>
        out<span class="token punctuation">.</span><span class="token function">createNewFile</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">BufferedWriter</span> bw <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BufferedWriter</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">FileWriter</span><span class="token punctuation">(</span>out<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">String</span> inPath <span class="token operator">=</span> <span class="token string">&quot;/home/northboat/Desktop/data/output_1.txt&quot;</span><span class="token punctuation">;</span>
        <span class="token class-name">File</span> in <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span>inPath<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">BufferedReader</span> br <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BufferedReader</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">FileReader</span><span class="token punctuation">(</span>in<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">String</span> line<span class="token punctuation">;</span>
        <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token punctuation">(</span>line <span class="token operator">=</span> br<span class="token punctuation">.</span><span class="token function">readLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token comment">/*if(line.charAt(0) == '&amp;'){
                line = '&lt;' + line.substring(4, line.length()-4) + '&gt;';
            }
            bw.write(line + '\n');*/</span>
            bw<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>line <span class="token operator">+</span> <span class="token char">'\\'</span> <span class="token operator">+</span> <span class="token char">'n'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            bw<span class="token punctuation">.</span><span class="token function">flush</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        bw<span class="token punctuation">.</span><span class="token function">flush</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        bw<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        br<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br></div></div><p>然后捏，我把标准答案（一大堆包括换行的字符串），写死在我所要提交的主函数中，这里的内容非常非常长，直接干到一两万字去了</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">private</span> <span class="token class-name">String</span> str1 <span class="token operator">=</span> <span class="token string">&quot;...&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">private</span> <span class="token class-name">String</span> str2 <span class="token operator">=</span> <span class="token string">&quot;...&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">private</span> <span class="token class-name">String</span> str3 <span class="token operator">=</span> <span class="token string">&quot;...&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">private</span> <span class="token class-name">String</span> str4 <span class="token operator">=</span> <span class="token string">&quot;...&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">private</span> <span class="token class-name">String</span> str5 <span class="token operator">=</span> <span class="token string">&quot;...&quot;</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>OK，然后我的工作就更简单了，我只要识别输入，然后将对应的答案 str 写到指定的文件 out.txt 中就行，这里的所谓的识别也是看出来的，因为每个样例有较明显的特征（比方说长度）</p> <p>RudeWrite.java</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token operator">*</span></span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RudeWrite</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getAns</span><span class="token punctuation">(</span><span class="token keyword">int</span> num<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">switch</span> <span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">case</span> <span class="token number">1</span><span class="token operator">:</span> <span class="token keyword">return</span> str1<span class="token punctuation">;</span>
            <span class="token keyword">case</span> <span class="token number">2</span><span class="token operator">:</span> <span class="token keyword">return</span> str2<span class="token punctuation">;</span>
            <span class="token keyword">case</span> <span class="token number">3</span><span class="token operator">:</span> <span class="token keyword">return</span> str3<span class="token punctuation">;</span>
            <span class="token keyword">case</span> <span class="token number">4</span><span class="token operator">:</span> <span class="token keyword">return</span> str4<span class="token punctuation">;</span>
            <span class="token keyword">case</span> <span class="token number">5</span><span class="token operator">:</span> <span class="token keyword">return</span> str5<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
        <span class="token class-name">RudeWrite</span> rw <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RudeWrite</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">String</span> inPath <span class="token operator">=</span> <span class="token string">&quot;testfile.txt&quot;</span><span class="token punctuation">;</span>
        <span class="token class-name">File</span> in <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span>inPath<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">String</span> outPath <span class="token operator">=</span> <span class="token string">&quot;output.txt&quot;</span><span class="token punctuation">;</span>
        <span class="token class-name">File</span> out <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span>outPath<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>out<span class="token punctuation">.</span><span class="token function">exists</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            out<span class="token punctuation">.</span><span class="token function">createNewFile</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token class-name">BufferedWriter</span> bw <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BufferedWriter</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">OutputStreamWriter</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">FileOutputStream</span><span class="token punctuation">(</span>out<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&quot;UTF-8&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">BufferedReader</span> br <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BufferedReader</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">FileReader</span><span class="token punctuation">(</span>in<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">String</span> line <span class="token operator">=</span> br<span class="token punctuation">.</span><span class="token function">readLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>line<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">{</span>

        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>line<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token string">&quot;int gets&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token comment">//System.out.println(&quot;2号&quot;);</span>
            bw<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>rw<span class="token punctuation">.</span><span class="token function">getAns</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            bw<span class="token punctuation">.</span><span class="token function">flush</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            bw<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            br<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>line<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token string">&quot;int g_li&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token comment">//System.out.println(&quot;3号&quot;);</span>
            bw<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>rw<span class="token punctuation">.</span><span class="token function">getAns</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            bw<span class="token punctuation">.</span><span class="token function">flush</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            bw<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            br<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">int</span> count <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token keyword">while</span><span class="token punctuation">(</span>br<span class="token punctuation">.</span><span class="token function">readLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> count<span class="token operator">++</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>count <span class="token operator">&lt;</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            bw<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token punctuation">(</span>rw<span class="token punctuation">.</span><span class="token function">getAns</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>count <span class="token operator">&lt;</span> <span class="token number">1400</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token comment">//System.out.println(&quot;4号&quot;);</span>
            bw<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>rw<span class="token punctuation">.</span><span class="token function">getAns</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token comment">//System.out.println(&quot;5号&quot;);</span>
            bw<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>rw<span class="token punctuation">.</span><span class="token function">getAns</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        bw<span class="token punctuation">.</span><span class="token function">flush</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        bw<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        br<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br></div></div><p>无敌了，按道理来说应该是满分，但是最长的那一个样例后半段没有匹配上，可能粘答案的时候或者洗数据的时候有点小纰漏，话又说回来，不得满分才是生存之道，被吕艳霞逮到就不好了</p></div></div> <!----> <div class="page-edit"><!----> <!----> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">2025/06/24, 19:34:09</span></div></div> <div class="page-nav-wapper"><div class="page-nav-centre-wrap"><a href="/pages/e2dfea/" class="page-nav-centre page-nav-centre-prev"><div class="tooltip">编译原理基础</div></a> <a href="/pages/cf1664/" class="page-nav-centre page-nav-centre-next"><div class="tooltip">基于 C 的 Lisp 编译器</div></a></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/pages/e2dfea/" class="prev">编译原理基础</a></span> <span class="next"><a href="/pages/cf1664/">基于 C 的 Lisp 编译器</a>→
      </span></p></div></div></div> <div class="article-list"><div class="article-title"><a href="/archives/" class="iconfont icon-bi">最近更新</a></div> <div class="article-wrapper"><dl><dd>01</dd> <dt><a href="/pages/706b77/"><div>
            先进数据库技术（二）
            <!----></div></a> <span class="date">6-20</span></dt></dl><dl><dd>02</dd> <dt><a href="/pages/aecc6a/"><div>
            Java 静态代码分析
            <!----></div></a> <span class="date">6-19</span></dt></dl><dl><dd>03</dd> <dt><a href="/pages/2ce9d5/"><div>
            基于可擦除签名的权限切换协议
            <!----></div></a> <span class="date">6-5</span></dt></dl> <dl><dd></dd> <dt><a href="/archives/" class="more">更多文章&gt;</a></dt></dl></div></div></main></div> <div class="footer"><div class="icons"><a href="mailto:Arkrypto@qq.com" title="邮件" target="_blank" class="iconfont icon-youjian"></a><a href="https://github.com/Arkrypto" title="GitHub" target="_blank" class="iconfont icon-github"></a><a href="https://music.163.com/#/my/m/music/playlist?id=5123040741" title="音乐" target="_blank" class="iconfont icon-erji"></a></div> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="本站主题">Vdoing</a> 
    | Copyright © 2021-2025
    <span>Arkrypto | <a href="https://github.com/Arkrypto/Arkrypto.github.io/blob/main/LICENSE" target="_blank">MIT License</a></span></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          跟随系统
        </li><li class="iconfont icon-rijianmoshi">
          浅色模式
        </li><li class="iconfont icon-yejianmoshi">
          深色模式
        </li><li class="iconfont icon-yuedu">
          阅读模式
        </li></ul></div></div> <div class="body-bg" style="background:url() center center / cover no-repeat;opacity:0.5;"></div> <!----> <!----></div><div class="global-ui"><div class="reco-bgm-panel" data-v-b1d3339e><audio id="bgm" src="/song/The Sun Also Rises.mp3" data-v-b1d3339e></audio> <div class="reco-float-box" style="bottom:10px;z-index:999999;background-color:blackcadetblue;display:none;" data-v-b1d3339e data-v-41bcba48 data-v-b1d3339e><img src="/img/logo.png" data-v-b1d3339e></div> <div class="reco-bgm-box" style="left:10px;bottom:10px;z-index:999999;" data-v-b1d3339e data-v-41bcba48 data-v-b1d3339e><div class="reco-bgm-cover" style="background-image:url(/img/logo.png);" data-v-b1d3339e><div class="mini-operation" style="display:none;" data-v-b1d3339e><i class="reco-bgm reco-bgm-pause" style="display:none;" data-v-b1d3339e></i> <i class="reco-bgm reco-bgm-play" style="display:none;" data-v-b1d3339e></i></div> <div class="falut-message" style="display:none;" data-v-b1d3339e>
          播放失败
        </div></div> <div class="reco-bgm-info" data-v-b1d3339e data-v-41bcba48 data-v-b1d3339e><div class="info-box" data-v-b1d3339e><i class="reco-bgm reco-bgm-music music" data-v-b1d3339e></i>太阳照常升起</div> <div class="info-box" data-v-b1d3339e><i class="reco-bgm reco-bgm-artist" data-v-b1d3339e></i>久石譲</div> <div class="reco-bgm-progress" data-v-b1d3339e><div class="progress-bar" data-v-b1d3339e><div class="bar" data-v-b1d3339e></div></div></div> <div class="reco-bgm-operation" data-v-b1d3339e><i class="reco-bgm reco-bgm-last last" data-v-b1d3339e></i> <i class="reco-bgm reco-bgm-pause pause" style="display:none;" data-v-b1d3339e></i> <i class="reco-bgm reco-bgm-play play" data-v-b1d3339e></i> <i class="reco-bgm reco-bgm-next next" data-v-b1d3339e></i> <i class="reco-bgm reco-bgm-volume1 volume" data-v-b1d3339e></i> <i class="reco-bgm reco-bgm-mute mute" style="display:none;" data-v-b1d3339e></i> <div class="volume-bar" data-v-b1d3339e><div class="bar" data-v-b1d3339e></div></div></div></div> <div class="reco-bgm-left-box" data-v-b1d3339e data-v-41bcba48 data-v-b1d3339e><i class="reco-bgm reco-bgm-left" data-v-b1d3339e></i></div></div></div></div></div>
    <script src="/assets/js/app.2e02f8b2.js" defer></script><script src="/assets/js/3.b20caba6.js" defer></script><script src="/assets/js/37.5295b891.js" defer></script><script src="/assets/js/120.25359a70.js" defer></script>
  </body>
</html>
