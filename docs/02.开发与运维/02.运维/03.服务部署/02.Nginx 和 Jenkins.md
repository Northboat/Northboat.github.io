---
title: Nginx å’Œ Jenkins
date: 2025-4-14
permalink: /pages/ceab3a/
author: 
  name: Northboat
  link: https://github.com/Northboat
---

## Nginx

Nginxï¼ˆengine xï¼‰ æ˜¯ä¸€ä¸ªé«˜æ€§èƒ½çš„[HTTP](https://baike.baidu.com/item/HTTP)å’Œ[åå‘ä»£ç†](https://baike.baidu.com/item/åå‘ä»£ç†/7793488) web æœåŠ¡å™¨ï¼ŒåŒæ—¶ä¹Ÿæä¾›äº† IMAP/POP3/SMTP æœåŠ¡ã€‚Nginx æ˜¯ç”±ä¼Šæˆˆå°”Â·èµ›ç´¢è€¶å¤«ä¸ºä¿„ç½—æ–¯è®¿é—®é‡ç¬¬äºŒçš„ Rambler.ru ç«™ç‚¹ï¼ˆä¿„æ–‡ï¼šĞ Ğ°Ğ¼Ğ±Ğ»ĞµÑ€ï¼‰å¼€å‘çš„

å…¶å°†[æºä»£ç ](https://baike.baidu.com/item/æºä»£ç /3814213)ä»¥ç±»[BSDè®¸å¯è¯](https://baike.baidu.com/item/BSDè®¸å¯è¯/10642412)çš„å½¢å¼å‘å¸ƒï¼Œå› å®ƒçš„ç¨³å®šæ€§ã€ä¸°å¯Œçš„åŠŸèƒ½é›†ã€ç®€å•çš„é…ç½®æ–‡ä»¶å’Œä½ç³»ç»Ÿèµ„æºçš„æ¶ˆè€—è€Œé—»å

### æ­£å‘/åå‘ä»£ç†

æ­£å‘ä»£ç†

- VPNï¼šæŒ‚åœ¨å®¢æˆ·ç«¯ä¸Šçš„ä»£ç†
- å®¢æˆ·ç«¯ â†’ VPN â†’ æœåŠ¡å™¨

åå‘ä»£ç†ï¼šæŒ‚åœ¨æœåŠ¡å™¨ä¸Šçš„ä»£ç†

- ä½œä¸ºä¸­é—´ä»£ç†åˆ†å‘è¯·æ±‚ç»™æœåŠ¡å™¨ï¼Œå®ç°è´Ÿè½½å‡è¡¡
- å¦‚è®¿é—®`www.baidu.com`ï¼ŒæœåŠ¡ç«¯ä»£ç†è¿™ä¸ªåŸŸåï¼Œå°†è¯·æ±‚åˆ†å‘ç»™ä¸åŒçš„æœåŠ¡å™¨å»æ¥æ”¶è¯·æ±‚

### è´Ÿè½½å‡è¡¡

è½®è¯¢

- è½®è¯¢ï¼šè¯·æ±‚ä¾æ¬¡æ‰“åˆ°æœåŠ¡å™¨ï¼ˆå¾ªç¯ï¼‰
- åŠ æƒè½®è¯¢ï¼šä¼˜å…ˆæ‰“åˆ°æƒé‡è¾ƒé«˜çš„æœåŠ¡å™¨ï¼Œä¿è¯æœåŠ¡å™¨æ€§èƒ½æœ€å¤§åŒ–

IPHash

- Session ä¿å­˜åœ¨ Tomcat ä¸­ï¼Œç”¨ Redis å…±äº« Session
- é€šè¿‡ IP è¿›è¡Œè®¡ç®—ï¼Œå›ºå®šçš„ IP æ‰“åˆ°å›ºå®šçš„æœåŠ¡å™¨ï¼Œè¿™æ · Session å°±ä¸ä¼šä¸¢å¤±ï¼Œä½†ä¸€æ—¦è¿™å°æœåŠ¡å™¨æŒ‚äº†ï¼ŒSession ä¹Ÿå…¨æ²¡äº†

åŠ¨é™åˆ†ç¦»ï¼šé™æ€èµ„æºç›´æ¥é€šè¿‡ Nginx è¿”å›ï¼Œä¸èµ°é¡¹ç›®ï¼Œå¦‚å‰ç«¯é™æ€ç½‘é¡µ

### å¤æ³•å®‰è£…

ä¸Šä¼ å®‰è£…åŒ…ï¼Œè§£å‹æ£€æŸ¥

~~~bash
tar -axvf nginx-1.20.2.tar.gz

cd nginx-1.20.2.tar.gz

./configure
~~~

apt-get ä¸‹è½½ zlib

```sh
sudo apt-get install zlib1g-dev
```

apt-get ä¸‹è½½ pcre

```sh
sudo apt-get install libpcre3-dev
```

ç¼–è¯‘å®‰è£…

```sh
make && make install

whereis nginx
/usr/local/nginx

cd /usr/local/nginx
```

å¯åŠ¨å‘½ä»¤

~~~bash
cd ..
cd sbin
./nginx

./nginx -s stop #åœæ­¢

./nginx -s quit #å®‰å…¨é€€å‡ºï¼Œå¤„ç†å®Œè¯·æ±‚åé€€å‡º

./nginx -s reload #é‡æ–°åŠ è½½é…ç½®

ps aux|grep nginx #æŸ¥çœ‹nginxè¿›ç¨‹
~~~

### é…ç½®åŠä½¿ç”¨

æ ¸å¿ƒé…ç½®æ–‡ä»¶ nginx.conf

~~~bash
#user  nobody;
worker_processes  1;

#error_log  logs/error.log;
#error_log  logs/error.log  notice;
#error_log  logs/error.log  info;

#pid        logs/nginx.pid;


events {
	# æœ€å¤§workeræ•°é‡
    worker_connections  1024;
}


http {
    include       mime.types;
    default_type  application/octet-stream;

    #log_format  main  '$remote_addr - $remote_user [$time_local] "$request" '
    #                  '$status $body_bytes_sent "$http_referer" '
    #                  '"$http_user_agent" "$http_x_forwarded_for"';

    #access_log  logs/access.log  main;

    sendfile        on;
    #tcp_nopush     on;

    #keepalive_timeout  0;
    keepalive_timeout  65;
    
    #gzip  on;

    server {
        listen       8080;
        server_name  localhost;

        #charset koi8-r;

        #access_log  logs/host.access.log  main;

        location / {
            root   html;
            index  index.html index.htm;
        }

        #error_page  404              /404.html;

        # redirect server error pages to the static page /50x.html
        #
        error_page   500 502 503 504  /50x.html;
        location = /50x.html {
            root   html;
        }

        # proxy the PHP scripts to Apache listening on 127.0.0.1:80
        #
        #location ~ \.php$ {
        #    proxy_pass   http://127.0.0.1;
        #}

        # pass the PHP scripts to FastCGI server listening on 127.0.0.1:9000
        #
        #location ~ \.php$ {
        #    root           html;
        #    fastcgi_pass   127.0.0.1:9000;
        #    fastcgi_index  index.php;
        #    fastcgi_param  SCRIPT_FILENAME  /scripts$fastcgi_script_name;
        #    include        fastcgi_params;
        #}

        # deny access to .htaccess files, if Apache's document root
        # concurs with nginx's one
        #
        #location ~ /\.ht {
        #    deny  all;
        #}
    }


    # another virtual host using mix of IP-, name-, and port-based configuration
    #
    #server {
    #    listen       8000;
    #    listen       somename:8080;
    #    server_name  somename  alias  another.alias;

    #    location / {
    #        root   html;
    #        index  index.html index.htm;
    #    }
    #}


    # HTTPS server
    #
    #server {
    #    listen       443 ssl;
    #    server_name  localhost;

    #    ssl_certificate      cert.pem;
    #    ssl_certificate_key  cert.key;

    #    ssl_session_cache    shared:SSL:1m;
    #    ssl_session_timeout  5m;

    #    ssl_ciphers  HIGH:!aNULL:!MD5;
    #    ssl_prefer_server_ciphers  on;

    #    location / {
    #        root   html;
    #        index  index.html index.htm;
    #    }
    #}
}
~~~

é…ç½® server

~~~bash
# é…ç½®è´Ÿè½½å‡è¡¡
upstream PerformanceSystem{
	# é‚®ä»¶å‘é€æœåŠ¡å™¨èµ„æº
	server 127.0.0.1:8084 weight=1;
	server 127.0.0.1:8085 weight=1; 
}

server {
	listen       8080;
	server_name  localhost;


	location / {
		root   html;
		index  index.html index.htm;
		# é…ç½®æœåŠ¡
		proxy_pass http://PerformanceSystem;
	}

	error_page   500 502 503 504  /50x.html;
	location = /50x.html {
		root   html;
	}
}
~~~

çƒ­éƒ¨ç½²

~~~bash
./nginx -s reload
~~~

è¿™æ ·å°†æ²¡æœ‰ä»»ä½•å¾å…†åœ°æ›´æ–°é…ç½®å¹¶æ·»åŠ æœåŠ¡

æ›´å¤šç”¨æ³•

- åŠ¨é™åˆ†ç¦»
- é‡å†™

[Jenkinsè‡ªåŠ¨åŒ–éƒ¨ç½²å…¥é—¨è¯¦ç»†æ•™ç¨‹ - javaè€å…µ - åšå®¢å›­](https://www.cnblogs.com/wfd360/p/11314697.html)

å…¶å® Netlify/Vercel å’Œ GitHub Action éƒ½æ˜¯ CI/CD æ–¹æ¡ˆï¼Œæ—©å°±ç”¨è¿‡äº†åªæ˜¯æ²¡æ„è¯†åˆ°è€Œå·²

## CI/CD æµç¨‹

### ä»€ä¹ˆæ˜¯ CI/CD

CI/CDï¼ˆContinuous Integration and Continuous Deliveryï¼‰ï¼Œå³æŒç»­é›†æˆå’ŒæŒç»­äº¤ä»˜

1. å¿«é€Ÿäº¤ä»˜ï¼šCI/CD è‡ªåŠ¨åŒ–æµç¨‹å¯ä»¥ä½¿è½¯ä»¶äº¤ä»˜è¿‡ç¨‹æ›´å¿«ã€æ›´é¢‘ç¹ï¼Œå‡å°‘äº†æ‰‹åŠ¨æ“ä½œå’Œäººå·¥å¹²é¢„çš„æ—¶é—´ã€‚è¿™æ ·å¯ä»¥æ›´å¿«åœ°å°†æ–°åŠŸèƒ½ã€ä¿®å¤å’Œæ”¹è¿›çš„ä»£ç äº¤ä»˜ç»™ç”¨æˆ·ï¼Œæ»¡è¶³å¸‚åœºéœ€æ±‚å¹¶ä¿æŒç«äº‰ä¼˜åŠ¿
2. æé«˜è´¨é‡ï¼šæŒç»­é›†æˆé€šè¿‡é¢‘ç¹åœ°é›†æˆå’Œæ„å»ºä»£ç ï¼Œå¹¶è¿›è¡Œè‡ªåŠ¨åŒ–æµ‹è¯•å’Œé™æ€ä»£ç åˆ†æï¼Œæœ‰åŠ©äºå‘ç°å’Œè§£å†³é—®é¢˜ã€‚é€šè¿‡å°½æ—©å‘ç°å’Œä¿®å¤ç¼ºé™·ï¼Œå¯ä»¥æé«˜è½¯ä»¶çš„è´¨é‡å’Œç¨³å®šæ€§
3. è‡ªåŠ¨åŒ–éƒ¨ç½²ï¼šæŒç»­äº¤ä»˜å°†éƒ¨ç½²è¿‡ç¨‹è‡ªåŠ¨åŒ–ï¼Œä»è€Œå‡å°‘äº†æ‰‹åŠ¨éƒ¨ç½²çš„é”™è¯¯å’Œé£é™©ã€‚é€šè¿‡è‡ªåŠ¨åŒ–éƒ¨ç½²æµç¨‹ï¼Œå¯ä»¥ç¡®ä¿è½¯ä»¶åœ¨ä¸åŒç¯å¢ƒä¸­çš„ä¸€è‡´æ€§ï¼Œå¹¶å‡å°‘äº†éƒ¨ç½²æ—¶é—´å’Œå·¥ä½œé‡
4. å¯é æ€§å’Œå¯é‡å¤æ€§ï¼šCI/CD å¼ºè°ƒè‡ªåŠ¨åŒ–å’Œæ ‡å‡†åŒ–çš„æµç¨‹ï¼Œä½¿è½¯ä»¶äº¤ä»˜è¿‡ç¨‹å˜å¾—å¯é å’Œå¯é‡å¤ã€‚æ¯æ¬¡æ„å»ºã€æµ‹è¯•å’Œéƒ¨ç½²éƒ½æ˜¯åŸºäºç›¸åŒçš„æµç¨‹å’Œç¯å¢ƒï¼Œå‡å°‘äº†äººä¸ºå› ç´ çš„å½±å“ï¼Œæé«˜äº†è½¯ä»¶äº¤ä»˜çš„ä¸€è‡´æ€§å’Œå¯é æ€§
5. å›¢é˜Ÿåä½œä¸åé¦ˆï¼šCI/CD ä¿ƒè¿›äº†å›¢é˜Ÿæˆå‘˜ä¹‹é—´çš„åä½œå’Œæ²Ÿé€šã€‚é€šè¿‡é¢‘ç¹åœ°é›†æˆå’Œäº¤ä»˜ï¼Œå›¢é˜Ÿæˆå‘˜å¯ä»¥åŠæ—¶äº†è§£å½¼æ­¤çš„å·¥ä½œè¿›å±•å’Œå˜æ›´ï¼Œå‡å°‘ä»£ç å†²çªå’Œé›†æˆé—®é¢˜ï¼Œå¹¶èƒ½å¤Ÿæ›´å¥½åœ°åˆä½œè§£å†³å‡ºç°çš„é—®é¢˜
6. å¯è¿½æº¯æ€§å’Œå›æ»šèƒ½åŠ›ï¼šç”±äº CI/CD è‡ªåŠ¨åŒ–æµç¨‹çš„è®°å½•å’Œç‰ˆæœ¬æ§åˆ¶ï¼Œå¯ä»¥è½»æ¾è¿½è¸ªæ¯ä¸ªæ„å»ºå’Œéƒ¨ç½²çš„ç»“æœã€‚è¿™æ ·ï¼Œåœ¨å‡ºç°é—®é¢˜æ—¶å¯ä»¥å¿«é€Ÿå®šä½å’Œå›æ»šåˆ°ä¹‹å‰çš„å¯ç”¨ç‰ˆæœ¬ï¼Œå‡å°‘äº†æ•…éšœä¿®å¤æ—¶é—´å’Œå½±å“èŒƒå›´ã€‚

æ€»è€Œè¨€ä¹‹ï¼ŒCI/CD æä¾›äº†ä¸€ç§é«˜æ•ˆã€å¯é å’Œå¯æŒç»­çš„è½¯ä»¶äº¤ä»˜æ–¹æ³•ã€‚å®ƒå¯ä»¥åŠ é€Ÿè½¯ä»¶å¼€å‘å’Œäº¤ä»˜çš„é€Ÿåº¦ï¼Œæé«˜è½¯ä»¶è´¨é‡å’Œå¯é æ€§ï¼Œå¹¶ä¿ƒè¿›å›¢é˜Ÿä¹‹é—´çš„åä½œå’Œåé¦ˆã€‚é€šè¿‡ä½¿ç”¨ CI/CDï¼Œç»„ç»‡å¯ä»¥æ›´å¥½åœ°é€‚åº”å¸‚åœºéœ€æ±‚ï¼Œé™ä½è½¯ä»¶äº¤ä»˜çš„é£é™©ï¼Œå¹¶å®ç°æŒç»­åˆ›æ–°å’Œæ”¹è¿›

CI/CD å¯ä»¥åŸºäºå„ç§æœåŠ¡å’Œå·¥å…·æ¥æ­å»ºï¼Œå…·ä½“é€‰æ‹©å–å†³äºé¡¹ç›®éœ€æ±‚ã€[æŠ€æœ¯æ ˆ](https://so.csdn.net/so/search?q=æŠ€æœ¯æ ˆ&spm=1001.2101.3001.7020)å’Œå›¢é˜Ÿåå¥½ã€‚ä»¥ä¸‹æ˜¯ä¸€äº›å¸¸ç”¨çš„æœåŠ¡å’Œå·¥å…·

1. ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿï¼šå¦‚ Gitï¼ˆä¾‹å¦‚ GitHubã€GitLabã€Bitbucket ç­‰ï¼‰ç”¨äºç®¡ç†ä»£ç ç‰ˆæœ¬å’Œåä½œå¼€å‘
2. æŒç»­é›†æˆæœåŠ¡ï¼šå¦‚ Jenkinsã€CircleCIã€Travis CIã€GitLab CI/CD ç­‰ï¼Œç”¨äºè‡ªåŠ¨åŒ–æ„å»ºã€æµ‹è¯•å’Œé›†æˆä»£ç 
3. å®¹å™¨åŒ–å¹³å°ï¼šå¦‚ Docker å’Œ Kubernetesï¼Œç”¨äºåˆ›å»ºå’Œç®¡ç†å®¹å™¨åŒ–çš„åº”ç”¨ç¨‹åºç¯å¢ƒï¼Œå®ç°åº”ç”¨ç¨‹åºçš„å¯ç§»æ¤æ€§å’Œä¸€è‡´æ€§
4. äº‘å¹³å°å’Œéƒ¨ç½²æœåŠ¡ï¼šå¦‚ Amazon Web Servicesï¼ˆAWSï¼‰ã€Microsoft Azureã€Google Cloud Platformï¼ˆGCPï¼‰ç­‰ï¼Œæä¾›äº†å„ç§äº‘è®¡ç®—æœåŠ¡å’Œéƒ¨ç½²å·¥å…·ï¼Œå¦‚ AWS CodePipelineã€Azure DevOpsã€Google Cloud Build ç­‰
5. è‡ªåŠ¨åŒ–æµ‹è¯•å·¥å…·ï¼šå¦‚ Seleniumã€JUnitã€Pytest ç­‰ï¼Œç”¨äºç¼–å†™å’Œæ‰§è¡Œè‡ªåŠ¨åŒ–æµ‹è¯•è„šæœ¬ï¼ŒéªŒè¯ä»£ç çš„åŠŸèƒ½å’Œè´¨é‡
6. é™æ€ä»£ç åˆ†æå·¥å…·ï¼šå¦‚ SonarQubeã€ESLintã€PMD ç­‰ï¼Œç”¨äºé™æ€ä»£ç åˆ†æå’Œæ£€æŸ¥ï¼Œå¸®åŠ©å‘ç°æ½œåœ¨çš„ä»£ç è´¨é‡é—®é¢˜
7. é…ç½®ç®¡ç†å·¥å…·ï¼šå¦‚ Ansibleã€Chefã€Puppet ç­‰ï¼Œç”¨äºè‡ªåŠ¨åŒ–é…ç½®å’Œç®¡ç†åº”ç”¨ç¨‹åºå’ŒåŸºç¡€è®¾æ–½çš„ç¯å¢ƒ
8. æ—¥å¿—å’Œç›‘æ§å·¥å…·ï¼šå¦‚ ELK Stackï¼ˆElasticsearchã€Logstashã€Kibanaï¼‰ã€Prometheusã€Grafana ç­‰ï¼Œç”¨äºæ”¶é›†ã€åˆ†æå’Œç›‘æ§åº”ç”¨ç¨‹åºçš„æ—¥å¿—å’ŒæŒ‡æ ‡ã€‚

è¿™äº›æœåŠ¡å’Œå·¥å…·å¯ä»¥æ ¹æ®å…·ä½“éœ€æ±‚è¿›è¡Œç»„åˆå’Œé…ç½®ï¼Œå½¢æˆä¸€ä¸ªç¬¦åˆé¡¹ç›®è¦æ±‚çš„ CI/CD å·¥ä½œæµç¨‹ã€‚å¯ä»¥æ ¹æ®å›¢é˜Ÿçš„æŠ€æœ¯æ ˆå’Œåå¥½é€‰æ‹©é€‚åˆçš„å·¥å…·ï¼ŒåŒæ—¶è€ƒè™‘é›†æˆå’Œå…¼å®¹æ€§çš„å› ç´ ï¼Œä»¥ç¡®ä¿é¡ºç•…çš„ CI/CD å®æ–½

### Why Jenkins

åœ¨å®é™…å¼€å‘ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸è¦ä¸€è¾¹å¼€å‘ä¸€è¾¹æµ‹è¯•ï¼Œå½“ç„¶è¿™é‡Œè¯´çš„æµ‹è¯•å¹¶ä¸æ˜¯ç¨‹åºå‘˜å¯¹è‡ªå·±ä»£ç çš„å•å…ƒæµ‹è¯•ï¼Œè€Œæ˜¯åŒç»„ç¨‹åºå‘˜å°†ä»£ç æäº¤åï¼Œç”±æµ‹è¯•äººå‘˜æµ‹è¯•

æˆ–è€…å‰åç«¯åˆ†ç¦»åï¼Œç»å¸¸ä¼šä¿®æ”¹æ¥å£ï¼Œç„¶åé‡æ–°éƒ¨ç½²ï¼Œè¿™äº›æƒ…å†µéƒ½ä¼šæ¶‰åŠåˆ°é¢‘ç¹çš„æ‰“åŒ…éƒ¨ç½²

æ‰‹åŠ¨æ‰“åŒ…å¸¸è§„æ­¥éª¤ï¼š

1. æäº¤ä»£ç 
2. é—®ä¸€ä¸‹åŒç»„å°ä¼™ä¼´æœ‰æ²¡æœ‰è¦æäº¤çš„ä»£ç 
3. æ‹‰å–ä»£ç å¹¶æ‰“åŒ…ï¼ˆwar åŒ…ï¼Œæˆ–è€… jar åŒ…ï¼‰
4. ä¸Šä¼ åˆ° Linux æœåŠ¡å™¨
5. æŸ¥çœ‹å½“å‰ç¨‹åºæ˜¯å¦åœ¨è¿è¡Œ
6. å…³é—­å½“å‰ç¨‹åº
7. å¯åŠ¨æ–°çš„ jar åŒ…
8. è§‚å¯Ÿæ—¥å¿—çœ‹æ˜¯å¦å¯åŠ¨æˆåŠŸ
9. å¦‚æœæœ‰åŒäº‹è¯´ï¼Œè‡ªå·±è¿˜æœ‰ä»£ç æ²¡æœ‰æäº¤......å†æ¬¡é‡å¤ 1-8 çš„æ­¥éª¤ï¼ï¼ï¼ï¼ï¼ï¼ˆä¸€ä¸Šåˆæ²¡äº†ï¼‰

é‚£ä¹ˆï¼Œæœ‰ä¸€ç§å·¥å…·èƒ½å¤Ÿå®ç°ï¼Œå°†ä»£ç æäº¤åˆ° git åå°±è‡ªåŠ¨æ‰“åŒ…éƒ¨ç½²å‹’ï¼Œç­”æ¡ˆæ˜¯è‚¯å®šçš„ï¼šJenkins

- å½“ç„¶é™¤äº† Jenkins ä»¥å¤–ï¼Œä¹Ÿè¿˜æœ‰å…¶ä»–çš„å·¥å…·å¯ä»¥å®ç°è‡ªåŠ¨åŒ–éƒ¨ç½²ï¼Œå¦‚ Hudson ç­‰ï¼Œåªæ˜¯ Jenkins ç›¸å¯¹æ¥è¯´ï¼Œä½¿ç”¨å¾—æ›´å¹¿æ³›

å®é™…ä¸Šï¼ŒJenkins å°±æ˜¯ä¸€ä¸ªæŒç»­é›†æˆå·¥å…·ï¼ˆCI Service Toolï¼‰ï¼Œå¸¸ä¸ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿå¦‚ Git å’Œå®¹å™¨åŒ–å¹³å°å¦‚ Kubernetes ç­‰å®ç°ä¼ä¸šåŒ–çš„è½¯ä»¶è¿­ä»£éƒ¨ç½²

### Jenkins å·¥ä½œæµç¨‹

<img src="./assets/858186-20190804162611917-80438542.png">

é¦–å…ˆæˆ‘ä»¬æœ‰ä¸€ä¸ªç‰ˆæœ¬æ§åˆ¶æœåŠ¡å™¨ï¼Œå¦‚ GitHubï¼Œå½“ push ä»»åŠ¡æ‰§è¡Œåï¼Œå°†è§¦å‘å¯¹ Jenkins çš„é€šçŸ¥ï¼ˆé€šçŸ¥ä»–æˆ‘ä»£ç æ›´æ–°äº†ï¼Œä½ å¿«æ‹‰ä¸€ä¸‹é‡æ–°éƒ¨ç½²ï¼‰

- æ³¨æ„è¿™ä¸ªå·¥ä½œæ˜¯ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿå®ç°çš„

å½“æ”¶åˆ°é€šçŸ¥åï¼ŒJenkins å°†è°ƒç”¨æœ¬åœ°çš„ Git å’Œ Maven æ’ä»¶

1. git pull æ‹‰å–è¿œç«¯ä»“åº“çš„æ–°ä»£ç 
2. mvn package / go build æ‰“åŒ…å¯æ‰§è¡Œæ–‡ä»¶
3. å°†å¯æ‰§è¡Œçš„æ‰“åŒ…æ–‡ä»¶ä¸Šä¼ åˆ°æŒ‡å®šæœåŠ¡å™¨çš„æŒ‡å®šç›®å½•ä¸‹

ä¸Šä¼ åˆ°æœåŠ¡å™¨åï¼ŒJenkins å°†æ‰§è¡Œäº‹å…ˆé…ç½®å¥½çš„ Linux å‘½ä»¤ï¼Œä¾‹å¦‚

```bash
cd /home/arkrypto/app
./stop.sh
./start.sh
```

äºæ˜¯ä»»åŠ¡è½¬å˜ä¸ºå¸¸è§„çš„ sh è„šæœ¬éƒ¨ç½²ï¼Œäº‹å…ˆç¼–å†™å¥½`stop.sh / start.sh`å¹¶æ”¾åœ¨æŒ‡å®šç›®å½•å³å¯

## Jenkins æ­å»ºä¸éƒ¨ç½²

### å®‰è£…åŠåˆå§‹åŒ–

ä¸‹è½½ war åŒ… [jenkins.war](http://mirrors.jenkins.io/war-stable/latest/jenkins.war)ï¼Œæ³¨æ„æœ¬åœ° JDK ç‰ˆæœ¬å’Œ Jenkins çš„å¯¹åº”

<img src="./assets/image-20250414152436430.png">

ç”¨ Java å¯åŠ¨ Jenkins

```sh
java -jar jenkins.war --httpPort=8090
```

è¿›å…¥æµè§ˆå™¨é¡µé¢`localhost:8090`ï¼Œæ ¹ç»é¡µé¢æç¤ºï¼Œæ‰¾åˆ°æœ¬åœ°å¯†é’¥æ–‡ä»¶ï¼Œå¡«å†™åˆå§‹å¯†ç ï¼Œè§£é”ç³»ç»Ÿ

<img src="./assets/image-20250414151736379.png">

æ’ä»¶å®‰è£…é€‰æ‹©ï¼šå®‰è£…æ¨èçš„æ’ä»¶ï¼Œç­‰å¾…

<img src="./assets/image-20250414151703759.png">

è®¾ç½®åˆå§‹ç”¨æˆ·å’Œå¯†ç ï¼Œåˆå§‹åŒ–å®Œæˆï¼Œè¿›å…¥ç³»ç»Ÿ

<img src="./assets/image-20250414152242583.png">

### å®‰å…¨åŠå‡­è¯é…ç½®

ç”¨æˆ·æ‰‹å†Œï¼š[User Handbook Overview](https://www.jenkins.io/doc/book/getting-started/)

å®‰å…¨è®¾ç½®

<img src="./assets/image-20250414164955236.png">

Security è®¾ç½®

<img src="./assets/image-20250414164047705.png">

<img src="./assets/image-20250414164245790.png">

åˆ›å»ºå‡­è¯ï¼ˆç¬¬ä¸€æ¬¡è¿›å…¥ç³»ç»Ÿå‡­è¯æ å°†æ˜¯ç©ºçš„ï¼‰ï¼Œç‚¹å‡» Stores scoped to Jenkins çš„â€œå…¨å±€â€ï¼Œè€Œååœ¨å³ä¸Šæ–¹ç‚¹å‡» Add Credentials

<img src="./assets/image-20250414165911714.png">

åˆ›å»ºå‡­è¯

<img src="./assets/image-20250414170014320.png">

ID ä¸ºç©ºç³»ç»Ÿå°†è‡ªåŠ¨åˆ†é…ï¼Œè¿™ä¸ªå‡­è¯ä¹‹ååœ¨åˆ›å»º Item æ—¶ä¼šç”¨åˆ°

<img src="./assets/image-20250414170058799.png">

### å·¥å…·æ’ä»¶é…ç½®

å…¨å±€ Tools é…ç½®ï¼Œä¸»è¦æ˜¯ JDKã€Git å’Œ Maven

<img src="./assets/image-20250414164457490.png">

<img src="./assets/image-20250414163714518.png">

<img src="./assets/image-20250414163738887.png">

<img src="./assets/image-20250414163805080.png">

Plugins é…ç½®ï¼Œæ£€æŸ¥ Publish over SSH å’Œ Deploy to container Plugin æ˜¯å¦å®‰è£…æˆåŠŸå³å¯

### ç³»ç»Ÿé…ç½®

ç³»ç»Ÿè®¾ç½®ï¼Œé…ç½®éœ€è¦æ¨é€ jar åŒ…çš„è¿œç«¯æœåŠ¡å™¨

<img src="./assets/image-20250414170217580.png">

ç‚¹å‡» Systemï¼Œç¿»åˆ°æœ€ä¸‹é¢ï¼Œ**æ³¨æ„åªè¦åœ¨å®‰è£…å¥½ Publish over SSH åï¼Œåœ¨ç³»ç»Ÿé…ç½®ä¸­æ‰æœ‰è¿œç¨‹æœåŠ¡å™¨çš„é…ç½®é€‰é¡¹**

<img src="./assets/image-20250414171924051.png">

å…¶ä¸­ä¸Šé¢ä»…éœ€å¡«å†™ Passphraseï¼ˆè¿œç¨‹æœåŠ¡å™¨å¯†ç ï¼‰

ç‚¹å‡» SSH Servers æ–°å¢æœåŠ¡å™¨

<img src="./assets/image-20250414172445034.png">

ç‚¹å‡»å³ä¸‹è§’æµ‹è¯•è¿æ¥ï¼Œæ˜¾ç¤º Successï¼Œä¿å­˜é€€å‡ºå³å¯

å¦å¤–ä¸ºäº†æµ‹è¯•æ–¹ä¾¿ï¼Œå°† Jenkins URL æ”¹æˆæœ¬æœºåœ°å€ï¼Œè¿™ä¸ªåœ¨ä¹‹åä¼šç”¨åˆ°

<img src="./assets/image-20250420182514921.png">

## CI æµ‹è¯•

SpringBoot + Maven + GitHub + Jenkins

### Linux æœåŠ¡å™¨é…ç½®

å°†ä¸¤ä¸ªè„šæœ¬æ”¾åˆ°æœåŠ¡å™¨å¯¹åº”ç›®å½•ä¸‹`/home/arkrypto/app/`

stop.sh

```bash
#!/bin/bash
echo "Stop Procedure: GradeManagement-0.0.1-SNAPSHOT.jar.jar"
pid=`ps -ef |grep java|grep GradeManagement-0.0.1-SNAPSHOT.jar|awk '{print $2}'`
echo 'old Procedure pid:'$pid
if [ -n "$pid" ]
then
kill -9 $pid
fi
```

start.sh

```sh
#!/bin/bash
echo 'Start the program: GradeManagement-0.0.1-SNAPSHOT.jar'
chmod 777 /home/arkrypto/app/GradeManagement-0.0.1-SNAPSHOT.jar
echo '-------Starting-------'
cd /home/arkrypto/app/
nohup java -jar GradeManagement-0.0.1-SNAPSHOT.jar > log.out 2>&1 &
echo 'start success'
```

è®°å¾—ç»™æ–‡ä»¶åŠ æƒé™

```sh
chmod +x stop.sh start.sh
```

æ³¨æ„å¯åŠ¨å‘½ä»¤ä¸èƒ½ç”¨

```sh
nohup java -jar GradeManagement-0.0.1-SNAPSHOT.jar &
```

ä»–æ˜¯é˜»å¡çš„ï¼Œæ‰€ä»¥æœ€åç»™ Jenkins çš„åé¦ˆä¸€å®šä¼šè¶…æ—¶ï¼ˆæ‰‹åŠ¨éƒ¨ç½²æƒ¯äº†ï¼Œè¿™æ¡å‘½ä»¤å†å›è½¦å°±å¯ä»¥è·‘èµ·æ¥ï¼Œæ—¥å¿—å°†é»˜è®¤è¾“å‡ºåˆ°å½“å‰ç›®å½•ä¸‹çš„ nohup.outï¼‰

è€Œåº”è¯¥ç›´æ¥æŒ‚èµ·

```sh
nohup java -jar GradeManagement-0.0.1-SNAPSHOT.jar --server.port=8090 > log.out 2>&1 &
```

### Jenkins Job

å¤§ä½“æ­¥éª¤ï¼šåŸºç¡€é…ç½® â†’ æºç ç®¡ç† â†’ æ„å»ºè§¦å‘å™¨ â†’ æ„å»ºç¯å¢ƒ â†’ æ„å»º â†’ æ„å»ºåæ“ä½œ

ç‚¹å‡»æ–°å»º Itemï¼Œé€‰æ‹© Freestyle

<img src="./assets/image-20250420135329429.png">

#### åŸºç¡€é…ç½®

åŸºç¡€é…ç½®ï¼šé€‰æ‹© GitHub é¡¹ç›®ï¼Œå¡«å…¥é¡¹ç›®çš„ HTTP é“¾æ¥

<img src="./assets/image-20250420135634317.png">

#### æºç ç®¡ç†

æºç ç®¡ç†ï¼Œé…ç½® Git ä»“åº“ï¼Œæ·»åŠ å‡­è¯ï¼ˆè¿™ä¸ªå‡­è¯æ˜¯åœ¨â€œå®‰å…¨åŠå‡­è¯è®¾ç½®â€å¤„åˆ›å»ºçš„è´¦å·å¯†ç å‹å‡­è¯ï¼‰

<img src="./assets/image-20250420140036091.png">

#### é’©å­

æ„å»ºè§¦å‘å™¨ï¼šè¿™é‡Œåªéœ€è¦é…ç½®ä¸€ä¸ªèº«ä»½éªŒè¯ä»¤ç‰Œ`TOKEN_NAME`ï¼Œå½“å¤–éƒ¨ç”¨æˆ·è®¿é—® URL `JENKINS_URL/job/SpringBoot-Test/build?token=TOKEN_NAME`æ—¶ï¼Œå°±ä¼šè§¦å‘æ„å»ºæµç¨‹ï¼ˆä¸€ä¸ªç®€å•çš„ GET è¯·æ±‚ï¼‰

- ä¹‹å‰ç³»ç»Ÿé…ç½®çš„æ—¶å€™æœ‰ä¸€ä¸ª Jenkins URLï¼Œè®¾ç½®ä¸º`http://127.0.0.1``
- æ‰€ä»¥è¿™é‡Œçš„è¿æ¥å®é™…ä¸Šå°±æ˜¯`http://127.0.0.1:8080/job/SpringBoot-Test/build?token=SpringBootJenkinsTest`

<img src="./assets/image-20250420140402784.png">

#### ç¯å¢ƒé…ç½®

ç¯å¢ƒé…ç½®ä¸ç®¡å°±è¡Œ

<img src="./assets/image-20250420140556376.png">

#### æ„å»ºè®¾ç½®

æ„å»ºå‘½ä»¤ï¼šç”±äºæ˜¯åœ¨ Windows ä¸‹æ¨¡æ‹Ÿï¼Œæ‰€ä»¥ä½¿ç”¨ bat è„šæœ¬è¿›è¡Œæ„å»ºï¼Œå…ˆè¿›å…¥ java ç‰ˆæœ¬æ–‡ä»¶å¤¹ï¼Œå†ä½¿ç”¨ maven æ¸…ç†ã€æ‰“åŒ…

```bash
cd backend-java
mvn clean
mvn package
```

<img src="./assets/image-20250420141024861.png">

#### æ„å»ºåæ“ä½œ

æ„å»ºåæ­¥éª¤ï¼šè¿™é‡Œçš„é€‰æ‹©æ˜¯å°† jar åŒ…æ¨é€åˆ°æœåŠ¡å™¨ä¸Šï¼ˆé€šè¿‡ SSHï¼‰ï¼Œéœ€è¦é…ç½®ä¸€ä¸‹æœ¬åœ°ç›®å½•å’ŒæœåŠ¡å™¨ç›®å½•ï¼Œä»¥åŠæœåŠ¡å™¨ command

<img src="./assets/image-20250420145337264.png">

ä¸€åˆ‡å‡†å¤‡å°±ç»ªåï¼Œç‚¹å‡» Build Now æ‰§è¡Œç¬¬ä¸€æ¬¡ Jenkins æ“ä½œ

<img src="./assets/image-20250420145703479.png">

### Issues

#### ä»“åº“æ‹‰å–æŠ¥é”™

æ‹‰ä»“åº“æŠ¥é”™

```sh
ERROR: Couldn't find any revision to build. Verify the repository and branch configuration for this job.
SSH: Current build result is [FAILURE], not going to run.
Finished: FAILURE
```

åŸå› æ˜¯ï¼šè™½ç„¶æˆåŠŸæ‹‰å–äº†ä»“åº“ï¼Œä½†æ²¡æœ‰æ‰¾åˆ°å¯¹åº”çš„åˆ†æ”¯ï¼Œäºæ˜¯ç»ˆæ­¢

åˆšåˆšåœ¨é…ç½® GitHub ä»“åº“æ—¶ï¼Œæœ‰ä¸€ä¸ªåˆ†æ”¯çš„é€‰é¡¹ï¼Œé»˜è®¤ç»™çš„æ˜¯`*/master`ï¼Œä½†ç°åœ¨ä»“åº“é»˜è®¤çš„åˆ†æ”¯ä¸º`main`ï¼Œæ‰€ä»¥è¦ä¿®æ”¹ä¸º`*/main`

<img src="./assets/image-20250420150413634.png">

<img src="./assets/image-20250420150512901.png">

#### Maven æŠ¥é”™

```sh
C:\Users\northboat\.jenkins\workspace\SpringBoot-Test\backend-java>mvn package 
'mvn' ä¸æ˜¯å†…éƒ¨æˆ–å¤–éƒ¨å‘½ä»¤ï¼Œä¹Ÿä¸æ˜¯å¯è¿è¡Œçš„ç¨‹åº
æˆ–æ‰¹å¤„ç†æ–‡ä»¶ã€‚

C:\Users\northboat\.jenkins\workspace\SpringBoot-Test\backend-java>exit 9009 
Build step 'Execute Windows batch command' marked build as failure
SSH: Current build result is [FAILURE], not going to run.
Finished: FAILURE
```

é‡‡ç”¨çš„`Execute Windows batch command`çš„æ–¹å¼è¿›è¡Œæ„å»ºï¼Œä½†å‘½ä»¤è¡Œæ²¡æœ‰æ‰¾åˆ° mavenï¼Œä½†æˆ‘é…ç½®äº†ç¯å¢ƒå˜é‡ï¼Œåœ¨æœ¬åœ° cmd æµ‹è¯•ä¹Ÿæœ‰æ­£ç¡®è¾“å‡º

```sh
C:\Users\northboat>mvn -v
Apache Maven 3.9.1 (2e178502fcdbffc201671fb2537d0cb4b4cc58f8)
Maven home: D:\Env\apache-maven-3.9.1
Java version: 17.0.7, vendor: Oracle Corporation, runtime: D:\env\java\jdk17
Default locale: zh_CN, platform encoding: GBK
OS name: "windows 10", version: "10.0", arch: "amd64", family: "windows"
```

**é—®é¢˜æœ¬è´¨ï¼šè™½ç„¶åœ¨ Jenkins å…¨å±€å·¥å…·é‡Œé…ç½®äº† Mavenï¼Œä½†è¿™åªå¯¹ Jenkins å†…éƒ¨çš„ â€œæ„å»ºæ­¥éª¤ç±»å‹â€ä¸º Maven çš„æ­¥éª¤ç”Ÿæ•ˆ**

â¡ï¸ **Windows Batch Command** æ˜¯åœ¨ç³»ç»Ÿçš„ CMD ä¸­è¿è¡Œå‘½ä»¤ï¼Œå®ƒä¸ä¼šè‡ªåŠ¨åŠ è½½ Jenkins çš„å·¥å…·è·¯å¾„ï¼

æ‰€ä»¥è¿˜æ˜¯è¦é‡‡ç”¨ **Invoke top-level Maven targets** çš„æ–¹å¼æ„å»º

<img src="./assets/image-20250420152505984.png">

ç”±äºæˆ‘çš„ Java æºç å¹¶ä¸åœ¨æ ¹ç›®å½•ï¼Œè€Œæ˜¯åœ¨ backend-java ç›®å½•ä¸‹ï¼Œæ‰€ä»¥è¦æ‰‹åŠ¨é…ç½® POM çš„ä½ç½®ä¸º`backend-java/pom.xml`ï¼Œè¿™æ ·ä»–å°±èƒ½æ ¹æ® pom.xml ç›¸å¯¹ä½ç½®æ­£ç¡®æ‰¾åˆ°å¯¹åº”æºç è¿›è¡Œæ„å»ºäº†

è®°å¾—åˆ æ‰ä¸Šé¢é‚£ä¸ª`Windows Batch`ï¼Œå†æ¬¡æ„å»ºï¼Œéå¸¸å¥½ï¼Œæœ¬åœ°æ‹‰å–å¹¶æµ‹è¯•é€šè¿‡

```sh
  __________
 / ___  ___ \
/ / @ \/ @ \ \
\ \___/\___/ /\
 \____\/____/||
 /     /\\\\\//
|     |\\\\\\
 \      \\\\\\
   \______/\\\\
    _||_||_
2025-04-20T15:25:43.866+08:00  INFO 92960 --- [           main] c.a.g.GradeManagementApplicationTests    : Starting GradeManagementApplicationTests using Java 17.0.7 with PID 92960 (started by northboat in C:\Users\northboat\.jenkins\workspace\SpringBoot-Test\backend-java)
2025-04-20T15:25:43.869+08:00  INFO 92960 --- [           main] c.a.g.GradeManagementApplicationTests    : No active profile set, falling back to 1 default profile: "default"
2025-04-20T15:25:45.131+08:00  INFO 92960 --- [           main] o.s.b.a.w.s.WelcomePageHandlerMapping    : Adding welcome page: class path resource [static/index.html]
2025-04-20T15:25:45.336+08:00  INFO 92960 --- [           main] c.a.g.GradeManagementApplicationTests    : Started GradeManagementApplicationTests in 1.841 seconds (process running for 2.887)
[INFO] Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 2.897 s - in com.arkrypto.grademanagement.GradeManagementApplicationTests
[INFO] 
[INFO] Results:
[INFO] 
[INFO] Tests run: 1, Failures: 0, Errors: 0, Skipped: 0
[INFO] 
[INFO] 
[INFO] --- jar:3.3.0:jar (default-jar) @ GradeManagement ---
[INFO] Building jar: C:\Users\northboat\.jenkins\workspace\SpringBoot-Test\backend-java\target\GradeManagement-0.0.1-SNAPSHOT.jar
[INFO] 
[INFO] --- spring-boot:3.0.2:repackage (repackage) @ GradeManagement ---
[INFO] ------------------------------------------------------------------------
[INFO] BUILD SUCCESS
[INFO] ------------------------------------------------------------------------
[INFO] Total time:  9.422 s
[INFO] Finished at: 2025-04-20T15:25:46+08:00
[INFO] ------------------------------------------------------------------------
```

ä½†æ˜¯å‡ºç°äº†æ–°çš„é—®é¢˜

#### æ„å»ºåæ“ä½œæŠ¥é”™

æœåŠ¡å™¨åœ¨ä¸Šé¢é…ç½®è¿‡ï¼Œæµ‹è¯•è¿æ¥é€šè¿‡è¿‡

```sh
SSH: Connecting from host [DESKTOP-32RH6TB]
SSH: Connecting with configuration [è…¾è®¯-æ–°åŠ å¡] ...
SSH: EXEC: completed after 218 ms
SSH: Disconnecting configuration [è…¾è®¯-æ–°åŠ å¡] ...
ERROR: Exception when publishing, exception message [Exec exit status not zero. Status [127]]
Build step 'Send build artifacts over SSH' changed build result to UNSTABLE
Finished: UNSTABLE
```

å…¶ä¸­

- `Exec exit status not zero`ï¼šè¯´æ˜ Jenkins å°è¯•æ‰§è¡Œè¿œç¨‹å‘½ä»¤æ—¶ï¼Œè¿”å›ç ä¸ä¸º 0ï¼Œä»£è¡¨æ‰§è¡Œå¤±è´¥
- `Status [127]`ï¼šè¿™ä¸ªåœ¨ Linux ç³»ç»Ÿä¸­è¡¨ç¤º **â€œå‘½ä»¤æœªæ‰¾åˆ°â€**ï¼ˆCommand Not Foundï¼‰

å¥½å§ï¼Œæˆ‘ä»–å¦ˆå¿˜è®°æŠŠè„šæœ¬æ”¾åˆ°æœåŠ¡å™¨äº†ï¼Œéš¾ç»·

ä¸å¯¹ï¼Œæ”¾ä¸Šå»äº†è¿˜æ˜¯ä¸è¡Œï¼Œæˆ‘å‘ç° jar åŒ…å°±æ²¡ä¼ ä¸Šå»ï¼Œæˆ‘é‡å¤æ£€æŸ¥äº†â€œæ„å»ºåæ“ä½œâ€çš„é…ç½®ï¼Œå°è¯•ç»™æœåŠ¡å™¨ä¸Šæ–‡ä»¶å¤¹æ·»åŠ å†™æƒé™

```sh
chmod 755 /home/arkrypto/app
```

å¦‚æœæˆåŠŸä¸Šä¼ çš„è¯ï¼ŒJenkins æ§åˆ¶å°ä¼šæœ‰ç±»ä¼¼è¿™æ ·çš„è¾“å‡º

```sh
SSH: Transferred 1 file(s)
```

è¿™æ¬¡æ§åˆ¶å°è¾“å‡ºä¼¼ä¹å¾ˆæ­£å¸¸

```sh
SSH: Connecting from host [DESKTOP-32RH6TB]
SSH: Connecting with configuration [è…¾è®¯-æ–°åŠ å¡] ...
SSH: EXEC: completed after 204 ms
SSH: Disconnecting configuration [è…¾è®¯-æ–°åŠ å¡] ...
SSH: Transferred 1 file(s)
Finished: SUCCESS
```

ä½†æ˜¯æ›´å¤§çš„é—®é¢˜æ¥äº†ï¼Œæˆ‘ TM æœåŠ¡å™¨ä¸Šæ­»æ´»æ‰¾ä¸åˆ° jar åŒ…ï¼Œå¦‚ä¼ ï¼ŒWTF

OKï¼Œæˆ‘å¥½åƒå‘ç°äº†é—®é¢˜æ‰€åœ¨ï¼Œæˆ‘åœ¨ç³»ç»ŸæœåŠ¡å™¨é…ç½®ä¸­ SSH Servers å¿˜è®°å¡«æ ¹ç›®å½•äº†

<img src="./assets/image-20250420161855363.png">

ç›¸åº”çš„åœ¨é¡¹ç›® Job ä¸­çš„è¿œç¨‹ç›®å½•ç½®ç©º

<img src="./assets/image-20250420161959015.png">

gOOdï¼Œç»ˆäºæˆåŠŸä¼ ä¸Šå»äº†

```sh
root@VM-0-11-debian:/home/arkrypto/app# ls
GradeManagement-0.0.1-SNAPSHOT.jar  nohup.out  start.sh  stop.sh
```

#### Jar åŒ…å¯¼å‡ºè®¾ç½®

ç”±äºæ˜¯ maven æ„é€ ï¼Œæˆ‘ä»¬å…³æ³¨ç‚¹å¿…ç„¶æ˜¯åœ¨ pom.xmlï¼Œè¿™é‡Œæ˜¯ springboot é¡¹ç›®ï¼Œç”¨åˆ° maven æ’ä»¶è¿›è¡Œå¯¼å‡ºï¼Œæœ‰å¦‚ä¸‹é…ç½®

```xml
<build>
    <plugins>
        <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-compiler-plugin</artifactId>
            <version>3.8.1</version>
            <configuration>
                <source>17</source>
                <target>17</target>
                <encoding>UTF-8</encoding>
            </configuration>
        </plugin>
        <plugin>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-maven-plugin</artifactId>
            <version>${spring-boot.version}</version>
            <configuration>
                <mainClass>com.arkrypto.grademanagement.GradeManagementApplication</mainClass>
                <skip>true</skip>
            </configuration>
            <executions>
                <execution>
                    <id>repackage</id>
                    <goals>
                        <goal>repackage</goal>
                    </goals>
                </execution>
            </executions>
        </plugin>
    </plugins>
</build>
```

è¿™ä¸ª`pom.xml`é…ç½®å·²ç»éå¸¸æ¥è¿‘æˆåŠŸäº†ï¼Œé—®é¢˜çš„å…³é”®åœ¨äºè¿™ä¸€å¥

```xml
<skip>true</skip>
```

ğŸ’¥ **è¿™ä¸ªé…ç½®ç­‰äºå‘Šè¯‰ Mavenï¼šè·³è¿‡ Spring Boot æ’ä»¶çš„æ‰§è¡Œï¼**
 ä¹Ÿå°±æ˜¯è¯´ï¼Œè™½ç„¶ä½ é…ç½®äº† `repackage` ç›®æ ‡ï¼Œ**ä½†ç”±äºè®¾ç½®äº† `skip=true`ï¼Œè¿™ä¸ªç›®æ ‡æ ¹æœ¬æ²¡è¢«æ‰§è¡Œ**ï¼Œæ‰€ä»¥ JAR åŒ…å°±æˆäº†æ™®é€š JARï¼Œæ²¡æœ‰ `Main-Class`ï¼Œäºæ˜¯å¯¼è‡´å¯åŠ¨æŠ¥é”™

```sh
no main manifest attribute, in GradeManagement-0.0.1-SNAPSHOT.jar
```

âœ… æ­£ç¡®åšæ³•ï¼šä½ åªéœ€è¦æŠŠ `<skip>true</skip>` **åˆ æ‰**æˆ–è€…æ”¹ä¸º

```xml
<skip>false</skip>
```

æˆ–è€…ï¼Œå¹²è„†ç›´æ¥åˆ æ‰æ•´ä¸ª`<configuration>`å—ï¼Œå¦‚æœä½ ä¸éœ€è¦æ‰‹åŠ¨æŒ‡å®š`mainClass`

- Spring Boot ä¼šè‡ªåŠ¨è¯†åˆ«å¸¦æœ‰`@SpringBootApplication`æ³¨è§£çš„ç±»

### GitHub é…ç½®

è¿˜è®°å¾—é‚£ä¸ª URL å—ï¼š`JENKINS_URL/job/SpringBoot-Test/build?token=TOKEN_NAME`

ç”±äºæˆ‘å®åœ¨æœ¬åœ°éƒ¨ç½²ï¼Œæ‰€ä»¥ URL å°±æ˜¯

```sh
http://localhost:8080/job/SpringBoot-Test/build?token=SpringBootJenkinsTest
```

ä½¿ç”¨[è´é”èŠ±ç”Ÿå£³ç®¡ç† - å†…ç½‘ç©¿é€](https://console.hsk.oray.com/forward)å°†`localhost:8090`ç©¿é€åˆ°`https://889ehmd12181.vicp.fun`

äºæ˜¯å›è°ƒ URL å˜ä¸º

```
https://889ehmd12181.vicp.fun/job/SpringBoot-Test/build?token=SpringBootJenkinsTest
```

ç‚¹å¼€ä»“åº“è®¾ç½®

<img src="./assets/image-20250420170537187.png">

æ·»åŠ å‹¾å­

<img src="./assets/image-20250420173156047.png">

æ¨é€ä¸€ä¸‹ï¼Œæµ‹è¯•ä¸€ä¸‹ï¼Œç„¶åï¼Œå¤±è´¥äº†

è€Œåæˆ‘æµ‹è¯•äº†ä¸€ä¸‹åœ¨æµè§ˆå™¨ç›´æ¥è®¿é—® https://889ehmd12181.vicp.fun/job/SpringBoot-Test/build?token=SpringBootJenkinsTestï¼Œæ˜¯èƒ½å¤Ÿè§¦å‘ä»»åŠ¡çš„

å†ä¸€ç»†çœ‹ï¼Œå“¦ï¼ŒGitHub çš„ WebHook å‘é€çš„æ˜¯ Post è¯·æ±‚ï¼Œè€Œéè§¦å‘ä»»åŠ¡çš„ Getï¼ŒåŒ…æˆåŠŸä¸äº†çš„ï¼Œè¿™é‡Œéœ€è¦ä¿®æ”¹ Jenkins Job çš„é…ç½®ï¼Œä¹‹å‰åœ¨ Jenkins Job / é’©å­é…ç½®çš„æ—¶å€™ï¼Œä½¿ç”¨çš„æ˜¯â€œèº«ä»½éªŒè¯ä»¤ç‰Œâ€

<img src="./assets/image-20250420140402784.png">

æ”¹æˆ`GitHub hook trigger for GITScm polling`

<img src="./assets/image-20250420180547249.png">

ç„¶ååœ¨ç³»ç»Ÿè®¾ç½®ä¸­ï¼Œæ‰¾åˆ° GitHub æ’ä»¶ï¼Œç‚¹å‡»é«˜çº§ï¼Œæ·»åŠ  Hook URL è®¾ç½®ï¼ˆè¿™é‡Œç›´æ¥ç”¨çš„æœ¬æœºåœ°å€ 127.0.0.1ï¼Œåæ­£ä¼šè¢«ç©¿å‡ºå»ï¼‰

<img src="./assets/image-20250420182222316.png">

ç„¶åä¿®æ”¹ GitHub çš„ WebHook é…ç½®

<img src="./assets/image-20250420182313374.png">

æ€»ç®— NMB æˆåŠŸäº†

<img src="./assets/image-20250420182100739.png">

<img src="./assets/image-20250420182740693.png">

## æ›´å¤š CI/CD

### GitHub Action

ç”¨ GitHub Action éƒ¨ç½²é™æ€åšå®¢ï¼Œæœ¬åœ° buildï¼Œä½¿ç”¨ GitHub Action å¯¹`./docs/.vuepress/dist`æ–‡ä»¶å¤¹ä¸‹çš„é™æ€ HTML è¿›è¡Œè‡ªåŠ¨åŒ–éƒ¨ç½²

é…ç½®æ–‡ä»¶ï¼š`.github/workflows/static.yml`

```yaml
# Simple workflow for deploying static content to GitHub Pages
name: Deploy static content to Pages

on:
  # Runs on pushes targeting the default branch
  push:
    branches: ["main"]

  # Allows you to run this workflow manually from the Actions tab
  workflow_dispatch:

# Sets permissions of the GITHUB_TOKEN to allow deployment to GitHub Pages
permissions:
  contents: read
  pages: write
  id-token: write

# Allow only one concurrent deployment, skipping runs queued between the run in-progress and latest queued.
# However, do NOT cancel in-progress runs as we want to allow these production deployments to complete.
concurrency:
  group: "pages"
  cancel-in-progress: false

jobs:
  # Single deploy job since we're just deploying
  deploy:
    environment:
      name: github-pages
      url: ${{ steps.deployment.outputs.page_url }}
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4
      - name: Setup Pages
        uses: actions/configure-pages@v4
      - name: Upload artifact
        uses: actions/upload-pages-artifact@v3
        with:
          # Upload entire repository
          path: './docs/.vuepress/dist'
      - name: Deploy to GitHub Pages
        id: deployment
        uses: actions/deploy-pages@v4
```

### Netlify

è‡ªåŠ¨åŒ–éƒ¨ç½² Slides PPTï¼Œåœ¨ Netlify ä¸­å¯¼å…¥ GitHub ä»“åº“ï¼Œé…ç½®`Site configuration`

<img src="./assets/image-20250501193118852.png">

ç½‘ç«™ URL å°†ä»¥`SiteName.netlify.app`çš„æ–¹å¼å‘ˆç°

æ¯”è¾ƒé‡è¦çš„é…ç½®ï¼šBuild & deploy

<img src="./assets/image-20250501193254767.png">

å…¶å®å’Œæœ¬åœ°ç¼–è¯‘çš„è¿‡ç¨‹ä¸€æ ·ï¼Œå› ä¸ºåœ¨ package.json é‡Œé¢å·²ç»å†™å¥½äº†å‘½ä»¤ï¼ŒNetlify è¿›è¡Œä¸‹è½½ã€ç¼–è¯‘æ˜¯å‚ç…§ package.json è¿›è¡Œçš„ï¼Œä¾‹å¦‚

```json
{
  "name": "bears-ppt",
  "private": true,
  "scripts": {
    "build": "slidev build",
    "dev": "slidev --open",
    "export": "slidev export"
  },
  "dependencies": {
    "@slidev/cli": "^0.40.16",
    "@slidev/theme-default": "*",
    "@slidev/theme-seriph": "^0.21.3",
    "resolve-from": "^5.0.0"
  },
  "devDependencies": {
    "playwright-chromium": "^1.48.2"
  }
}
```

æ‰€ä»¥è¿œç«¯å‘½ä»¤è®¾ç½®ä¸º npm run build å°±è¡Œ

<img src="./assets/image-20250501193542727.png">

å¦å¤–è¦æ³¨æ„é™æ€æ–‡ä»¶çš„ä½ç½®ï¼Œä¾‹å¦‚è¿™ä¸ªé¡¹ç›®å°†æŠŠ HTML æ–‡ä»¶ç”Ÿæˆåœ¨æ ¹ç›®å½•çš„ /dist ç›®å½•ä¸‹ï¼Œè¿™ä¸ªä¸€å®šæ˜¯è¦é…ç½®ä¸€è‡´çš„

<img src="./assets/image-20250501193658347.png">

æœ€åæ³¨æ„ä¸€ä¸‹æŒ‡å®š Node ç‰ˆæœ¬å’Œä»“åº“åˆ†æ”¯ï¼Œå…¶ä»–å°±æ²¡ä»€ä¹ˆäº†ï¼Œæ¯ä¸€æ¬¡ä»“åº“æ¨é€éƒ½ä¼šè§¦å‘ Netlify çš„è‡ªåŠ¨æ„å»ºä»»åŠ¡ï¼Œæµç¨‹å’Œ Jenkins å®Œå…¨ä¸€è‡´ï¼šgit pull â†’ build â†’ deploy
